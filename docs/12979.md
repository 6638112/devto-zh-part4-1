# 构建 JSON 解析器大有裨益

> 原文:[https://dev . to/kali um/building-a-JSON-parser-for-great-good-39mo](https://dev.to/kalium/building-a-json-parser-for-great-good-39mo)

## [](#motivation)动机

了解编程语言的一个好方法是理解它们是如何工作的。理解一件事的最好方法是首先去做。今天，我们开始使用[json.org](//json.org)上的规范构建一个简单的 JSON 解析器。JSON 是一个相当简单且有良好文档记录的规范，因此它是学习如何编写解析器的好目标。

## [](#process-of-parsing)解析的过程

JSON 被解析成数据结构，所以我们除了将 JSON 字符串转换成数据结构之外，什么都不用担心。将 JSON 文件翻译成更抽象的 JSON 对象的第一步称为标记化、词法分析或词法分析。这些术语经常互换使用。词法分析和词法分析更常用于自然语言处理，它们源于语言学。流程如下:

1.  用一个字符串调用记号赋予器，比如:`{ "key": "value"}`

2.  字符串被分解成有意义的单元(例如关键字、分隔符、运算符)。我们做到这一点的方法是简单地扫描每一个字符，并改变我们的操作模式来适应(见左花括号？我们在处理一个 JSON 对象，开方括号？一个数组)。这些意义单位被称为记号或词位。我们可以看到，我们的字符串以一个`{`开始，表明它是一个 JSON 对象，然后移动到下一个相关的标记，我们看到一个`"key"`、`:`、`"value"`，最后是 JSON 对象的结尾`}`。

3.  当我们识别它们时，令牌被放入结果数据结构中。在我们的例子中，我们的字符串在 JSON 的抽象表示中变成了一个根 JSON 对象。我们一识别出 JSON 对象就创建它。如果我们在这个过程中遇到任何格式错误的标记，我们将会惊慌失措，解析器将会退出，所以假设这个对象将是一个完整的 JSON 对象是一种节约。一旦我们看到键，我们就把它附加到我们的结构`(JSON object (key))`中，一旦我们看到值，我们就把它附加到键`(JSON object (key value))`中。

你可能想知道为什么我们仍然需要右大括号，或者为什么我们不仅仅在没有这些符号的情况下表示它，如果它们在这一点上没有贡献的话。我们的标记器像状态机一样工作，它根据调用它的输入来切换模式。`}`表示退出解析 JSON 对象，其中`,`表示后面还有更多键值对。

一旦我们将整个字符串转换成数据结构，我们就大功告成了，因为 JSON 比编程语言简单得多，我们不需要检查得到的数据结构来运行任何指令。程序可以决定如何使用你的 JSON 数据结构。

## [](#implementing-the-tokenizer)实现分词器

最简单的方法是遍历每个字符，并根据输入解析器的字符切换模式。您可以使用 switch 语句来实现这一点，该语句调用正确的函数来解析令牌。对于一个字符串，您会看到它以`"`开始，因此任何不是`"`的字符都需要被存储，后面的标记表示该字符串已经结束，您应该退出函数并返回要嵌入到您正在创建的数据结构中的字符串。

## [](#understanding-how-to-read-the-relevant-documents-for-implementing-a-json-parser)理解如何阅读实现 JSON 解析器的相关文档

这篇摘自《javascript 如何工作》的文章链接到了 json.org，并解释了“麦基曼形式”，阅读这篇文章并在实现不同模式的解析器时使用它作为指导是很好的，因为你可以比在语法图上更清楚地看到哪些类型包括什么:
[【https://www.crockford.com/mckeeman.html】](https://www.crockford.com/mckeeman.html)

如果你有任何建议或应该链接的来源，你可以[分叉这篇文章](https://github.com/kaliumxyz/posts/blob/master/JSON.md)。