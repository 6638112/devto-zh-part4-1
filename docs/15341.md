# PHP 7.4 中的预加载

> 原文：<https://dev.to/brendt/preloading-in-php-7-4-o92>

PHP 7.4 增加了预加载支持，这一特性可以显著提高代码的性能。

简而言之，这就是预加载的意义所在:

*   为了预加载文件，您需要编写一个定制的 PHP 脚本
*   该脚本在服务器启动时执行一次
*   所有预加载的文件都可以在内存中用于所有请求
*   在服务器重新启动之前，对源文件所做的更改不会有任何效果

我们来深入的看一下。

## Opcache，但更多

虽然预加载是建立在 opcache 之上的，但并不完全相同。Opcache 将获取你的 PHP 源文件，将其编译成“操作码”，并将这些编译好的文件存储在磁盘上。

您可以将“操作码”视为代码的低级表示，可以在运行时轻松解释。所以 opcache 跳过了源文件和 PHP 解释器在运行时实际需要的文件之间的转换步骤。巨大的胜利！

但是，还有更多的收获。Opcached 文件不知道其他文件。如果你有一个从类`B`扩展而来的类`A`，你仍然需要在运行时将它们链接在一起。此外，opcache 执行检查以查看源文件是否被修改，并基于此使其缓存无效。

这就是预加载发挥作用的地方:它不仅将源文件编译成操作码，还将相关的类、特征和接口链接在一起。然后，它会将这个“编译”的可运行代码的 blob 即:PHP 解释器可用的代码——保存在内存中。

当请求到达服务器时，它现在可以使用已经加载到内存中的部分代码库，而没有任何开销。

那么，我们所说的“代码库的一部分”是什么呢？请继续阅读 https://stitcher.io/blog/preloading-in-php-74 的文章。