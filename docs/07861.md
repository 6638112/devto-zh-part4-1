# JavaScript 构建工具去神秘化——总体思路

> 原文：<https://dev.to/jnielson94/javascript-build-tools-demystified-overall-thoughts-rough-362d>

*原载于[jnielson.com](https://jnielson.com/build-tools-demystified-my-thoughts)T3】*

又见面了。我要做的另一个工作演讲的准备贴。这个演讲要到 10 月初，所以如果你在那之后读到这篇文章，我希望它能帮到你。这篇文章之后可能会有另一篇文章，它采取了一种更“后谈”的方法，而这篇文章将是“关于主题的无组织的想法”。这可能很粗糙，但我想我会把它放在那里，以防有人感兴趣。如果这是你的难题，请继续读下去，我会感谢你的任何反馈！

我选择在这次内部工作会议上分享的主题集中在揭开工作中 JavaScript 栈中使用的构建工具的神秘面纱。我们利用 Next.js，一个奇妙的库，它使得我们很少需要与我们的构建工具交互，因为它们以一种通常不会破坏我们的应用程序的方式出色地更新了它们。有时，尽管我们的项目没有使用 Next.js(要么他们使用 Next.js 采用之前的旧版本堆栈，要么他们根本没有使用堆栈)，要么他们遇到了一些需要调整以适应他们特定项目的问题，他们来找我们询问各种有关构建工具的问题，因为他们遇到了问题。在这种情况下，了解一些关于这些工具在做什么以及它们为什么在那里的背景知识会很有帮助。

当使用 Next.js 时，它包括对 Babel 和 webpack 的配置和支持。它们的开箱即用配置相当可靠，并且在大多数情况下易于扩展。例如，我们已经在堆栈中包含了一个 babel 配置文件，它设置了样式组件 babel 插件，保持更新相对容易。我们帮助项目使用的其他构建工具包括 Gulp 和 Grunt，尽管目前我们没有多少项目改变 Gulp/Grunt 设置。这些大部分都是 AngularJS 的遗留项目，因为它们不会经常改变，所以我们不会在这篇文章中谈论它们。因此，我将重点关注 Babel 和 webpack。

对于那些不熟悉典型的 web 开发栈的人，我们利用 Babel 和 webpack 来获取我们编写的代码，并将其(编译/传输文件/你想叫它什么都行)更改为预期消费方法的理想格式。通常 JavaScript 代码在浏览器中使用，不同的浏览器支持不同的特性。

Babel 是一个 [JavaScript 编译器](https://babeljs.io)，它可以让你使用最新的语言特性编写代码，并根据你给它的配置进行转换。默认情况下，它实际上不做任何转换——它只使用你提供的插件进行转换。

webpack 是一个[捆绑器](https://webpack.js.org)，它将获取您提供给它的文件(通常称为“条目”)，并将引用的所有资产/代码收集到一组文件中，准备好提供给浏览器。

webpack 和 babel 最大的特点之一是通过一个庞大的插件生态系统的可扩展性。在很多情况下，人们会通过叫做`babel-loader`的东西在 webpack 中使用 Babel。webpack 使用加载器来定制文件类型在管道中的捆绑方式，因此在被 webpack 捆绑之前,`babel-loader`用于通过 Babel 运行文件。

在这两种情况下(直接使用 Babel 或在 webpack 中使用)，配置文件是许多“神奇”发生的地方，我将通过我的演讲来揭开这些神奇的地方。这个演讲的目的是让人们有一个工作词汇，他们可以在使用这些工具时谷歌搜索他们可能需要的不同东西，并为他们提供一些使用这些工具的策略。我最大的目标之一是让人们不那么害怕摆弄工具，因为通常你只需要试一试，看看它是否有效。

这两个神奇的工具都有完整的文档，webpack 文档中我最喜欢的一部分叫做[“概念”](https://webpack.js.org/concepts/)，因为它对 webpack 的主要功能进行了高度概括。这些主要概念包括:

*   [条目](https://webpack.js.org/concepts/#entry)
*   [输出](https://webpack.js.org/concepts/#output)
*   [装载机](https://webpack.js.org/concepts/#loaders)
*   [插件](https://webpack.js.org/concepts/#plugins)
*   [模式](https://webpack.js.org/concepts/#mode)

他们对他们的描述是准确的，但是为了将他们联系在一起，我将添加我自己的描述。本质上，webpack 获取一个入口点(或多个入口点)，通常是一个 JavaScript 文件，但不是必须的，并构建一个依赖关系图，利用基于文件路径的加载器，通过插件运行它，并以允许您利用一些预设内容的模式输出一组输出文件。

虽然 Babel 没有一个“概念”页面，但是从消费者的角度来看，理解一些重要的概念是很重要的。在我看来，这包括如下的想法和事情。注意，我不建议坐下来通读这些链接，因为它们非常密集。

*   [插件](https://babeljs.io/docs/en/plugins)
*   [预设](https://babeljs.io/docs/en/presets)
*   [选项](https://babeljs.io/docs/en/options)
*   [配置文件类型](https://babeljs.io/docs/en/config-files)
*   巴别塔手册的存在
*   [什么是`preset-env`，因为它是最常见的预设之一](https://babeljs.io/docs/en/babel-preset-env)

因此，虽然 Babel 可能没有一个专门的文档页面来描述他们的主要概念，但我发现人们会从理解这些内容中受益最多。由于链接到文档的页面有点密集，这里是我对这些主题的一些工作定义/视图。插件实际上是赋予巴别塔行为和能力的东西。如果你不使用任何插件，Babel 只会把你给它的代码给你。有几种类型的插件——转换和语法。语法插件更容易理解，因为它们甚至可以让 Babel 解析这个特性。虽然它们更容易理解，但是它们很少被直接使用，因为仅仅解析一种语言特性对于代码的消费者来说并没有太大的好处。因此，转换插件将加载它们需要的语法插件，并将相关代码转换成所需的输出。因为在每个项目中配置和加载你可能想要的所有插件是很乏味的，所以 Babel 允许预置，即预先配置的插件组。在预置和插件中，以及其他很多关于巴别塔的东西中，传入`options`的想法是非常有用的。选项允许插件和预设基于您的目标环境、您所处的“模式”(类似于 webpack)或它们被设置为处理的任何其他事情进行调整。有了 babel，有许多工具可以利用它，通过命令行传递预置和插件可能会变得非常乏味，所以有许多配置文件类型可供您使用，主要有两种——项目范围的和文件相关的。在撰写本文时，您通常希望在应用程序类型的项目或 monorepos 中使用的是项目范围的`babel.config.js`文件。库通常会使用一个文件相对配置，比如一个`.babelrc`文件(或者在他们的`package.json`文件中的某个东西，取决于他们配置的复杂程度)。如果你决定写一些其他人会用 Babel 的东西，上面链接的手册是一个很好的资源。如果你想调试别人的插件，插件手册会非常有用，因为他们在写的时候可能会用到。在我见过的大多数项目中，他们利用了巴别塔团队提供的`preset-env`。这方面的文档非常好，所以如果你打算直接使用它，我建议你去查阅一下。幸运的是，Next.js 为我们处理了很多配置，甚至提供了一个预置，我们可以使用它来扩展他们的配置(我们这样做是为了添加样式化组件支持)。

我想这就是我今天对整个话题的想法。随着我不断完善我将要谈论的内容，我可能会抛出一些其他更详细和具体的帖子。感谢阅读！

*封面图片由 undraw.com 提供*