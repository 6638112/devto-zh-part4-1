# 构建 Reddit 刮刀:问题与解决方案

> 原文：<https://dev.to/imtyrelchambers/build-a-reddit-scraper-problem-solution-337k>

# 本系列的目标

本系列将介绍我是如何使用 React/JavaScript 构建 Reddit scraper 的，我希望我能帮助解释一些 Reddit 的 API 是如何工作的。我的目标也是使这个初学者友好，然而，HTML/CSS/JS 的知识是必须的，但希望我能帮助你理解基础。

### **Reddex 怎么开始的**

Reddex 是我为了利用 Reddit 的 API 而开发的一款应用。作为一名从 Reddit 获取故事的故事讲述者，我需要一种方法来加快发现过程。我花了大约 3-4 个月的时间(用我自己的时间)来构建，我觉得这是一个非常可靠和有用的应用程序。

### **问题**

在我开发这个应用程序之前，寻找一个故事来阅读是一项非常乏味的任务。我会登录 Reddit，搜索 NoSleep subreddit，在数百个条目中滚动，找到一个拥有合理数量的上传投票和评论的条目。我让社区来决定哪些故事是好的，所以我主要看向上投票数。

对于每一个有 1000 个支持票的帖子，你必须滚动大约 30 个 0-100 个支持票的条目。浪费在滚动上的时间越来越多，日积月累到任务单调的地步；我并不期待做这件事。

我需要一种方法来减少这一时间，而不是试图创建一个人工智能来编辑我的音频，我认为这可能更可行。

Reddex 缩短了我 99%的发现时间。过去，只需点击几下鼠标，就可以花 5-10 分钟找到 1-2 个故事，而现在，我可以将预先保存的消息发送给多个文章作者，而不是:

*   复制故事标题
*   导航到他们的帐户
*   单击发送消息
*   将标题粘贴到主题行
*   打开记事本文档并复制脚本消息
*   将消息粘贴到消息字段，然后单击发送

重复每一个故事。

### **解**

解决这个大问题和耗时的方法是创建一个利用 Reddit API 的应用程序。这比人们想象的要困难得多。Reddit 的 API 文档不是用户友好的，你会经常发现自己试图通过 Reddit 的文档(通过谷歌)找到自己的路。

为了你的理智，我会推荐给重要的文件做书签。

我将从一般意义上描述我如何解决这个问题，如何用 React/JavaScript 构建 reddit scraper，用 Express 和 MongoDB 构建 NodeJS。在以后的文章中，我将介绍该应用程序的每个主要组件，希望能帮助您使用 JavaScript 创建自己的 Reddit 抓取器。

### **从子编辑中抓取帖子**

Reddit 没有你通常期望找到的 API，但是该 API 仍然是直接和一致的，一旦你习惯了它的工作方式，这将会有所帮助。

如果您导航到一个子编辑并添加。json 到 URL 的末尾，您将看到该页面的 JSON 版本和所有的帖子。这很好，因为我们可以用。json，并访问这些值。

因为即使在访问 JSON 版本时，它们也只返回最多 250 个 post，所以我们必须创建一个循环，对每组数据使用“after”属性来获取下一批 250 个 post。

一旦完成了这个大的获取，我就使用 Dexie.js 将帖子保存在浏览器中，它利用了 IndexedDb。我建议你去看看。

我选择了 Dexie.js，因为我提取的数据太大，无法保存在 localstorage 中。请记住，当你从 Reddit 上抓取帖子时，你会抓取大量带有大量文本的帖子，随着时间的推移，这些帖子会越来越多。使用 Dexie.js 有一个轻微的学习曲线，但我将向您展示我如何设置我的数据库(我可能会将它迁移到我自己的后端，但无论如何)。

在我们获取帖子之后，我调用一个函数返回数据库中的条目，并在页面上显示它们。

### **过滤子编辑帖子**

一旦帖子显示在屏幕上，就会出现一种过滤方法。对于过滤，我可以通过 upvote count，keywords(这将搜索标题和正文)和 Series Only(这将扩展到使用其他 flairs)进行过滤。

这允许我输入一些数字，应用过滤器，并立即(即时)看到与我的过滤查询匹配的帖子。

### **给作者发消息**

这是迄今为止最棘手的部分，我花了几个月的时间来解决和创造。

我会更深入地介绍我是如何构建 UI 的，以及我在这方面的选择，但在整体方案中，你可以选择一个或多个帖子，打开一个模态来确认每个单独的消息，从那里你可以向原始发帖者发送消息。

这是彻底消除向人们发送信息的麻烦的最后一步。我可以选择 10 个帖子，当我去确认每条消息时，主题会预填充故事的标题，你将向其发送消息的作者的姓名，你自己的用户名，以及一个预填充默认消息的文本区，你可以在应用程序的帐户部分定义。如果你想改变信息，你可以在个人层面上做。因此，使用预填充的消息进行填充，并单独进行修改。