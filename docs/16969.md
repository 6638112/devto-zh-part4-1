# 熟悉的第五天

> 原文：<https://dev.to/nickblow/familiar-day-5-10bd>

对于那些新来的人，我正在构建一个开源的桌面角色扮演助手。现在，我正致力于它的实时方面，因为我在另一个项目中需要它。

从纯 MVP 的角度来看，严格来说这不是最好的工作，但是因为我需要它做别的事情，所以我破例了...

到目前为止，我们已经创建了一个服务器，它能够通过服务器发送事件(SSE)传输到多个客户端。周末我没做什么，因为天气很好，休息一下有益健康。

我今天没有取得很大的进展，但我会谈谈我的问题。我需要多花些时间考虑一下。

### 这个问题

Go 允许通过[中间件](https://www.alexedwards.net/blog/making-and-using-middleware)轻松组合 HTTP 处理程序，我想确保[库](https://github.com/NickBlow/gqlssehandlers)是可合理插拔的。在理想情况下，处理程序应该与任何身份验证逻辑完全分离。

然而，SSE 只允许你做一个 GET 请求，这意味着唯一的认证方式必须是通过一个 cookie 或者一个查询字符串。订阅端点还需要知道哪个客户端实际上正在请求该订阅，并且流处理程序需要知道将数据发送给哪个客户端。

对于流处理程序，有一些解决方案，包括在握手端点上作为签名会话 cookie 生成的短期令牌。

对于订阅处理程序来说，创建一些身份验证是很容易的，但是 userID(或等价的)确实需要传递给订阅适配器。

我现在倾向于将一个可配置的认证函数传递给每个处理器，但这是库之上的另一层配置。

我会考虑一下，看看明天是否能更进一步。