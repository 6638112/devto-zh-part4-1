# 测试 Django Rest 框架

> [https://dev . to/viktorovillalobos/test-drf-la-form-right-40pf](https://dev.to/viktorvillalobos/testeando-drf-la-forma-correcta-40pf)

出版后:

[https://python ist . dev/articles/testing-django-drf-manera-correcta/](https://pythonist.dev/articles/testing-django-drf-manera-correcta/)

作为 django 开发人员，我们通常需要测试 DRF，但我们并不总是正确的，我们最终创建了缓慢而非孤立的单元测试，这使得我们很难发现错误并保持较高的复盖率，本文试图简单地解释

如何用 pytest 代替 django 的默认书店
进行测试。在整个过程中，请使用以下假设:

1.  使用 pytest 库进行单元测试。
2.  单元测试将无法访问数据库。
3.  我们将使用 pytest-mock“mock”我们不感兴趣测试的方法，如框架开发者已经测试过的框架专有的东西。

### ∞单元测试不应该访问数据库吗？

很多作者多年来一直在讨论，关于这一点，此刻给出
我个人的意见，是基于我作为网络开发者的经验。

随着您的项目的增长，固定的创建，对于大量的模型，会变得难以置信的麻烦，大量的迁移会增加问题，当然，每隔一段时间对迁移进行批处理可以减轻这一负担，
但还是经常很复杂，这一切加在一起就有

另一方面，不访问数据库的测试使我们能够单独测试。

## [](#porque-deber%C3%ADan-tus-tests-unitarios-ser-aislados)你的单元测试应该隔离吗？

隔离你的单元测试是你的代码脱离的一个例子，因为你遵循 Unix 原理，你的代码的每一部分只做一件事，做得很好，这当然有助于你有一个更可维护的代码。下面我给大家介绍一下隔离你们的‘T2’单元测试的一些优点:

*   很容易找到我们的错误。
*   我们不会依赖数据库，所以我们的测试会很快。
*   我们将促进应用程序的部署
*   我们将更深入地了解框架的工作原理。
*   当我们开始以这种方式测试时，我们将被迫创建一个更“可测试”的代码，使其更易于阅读、更有条理和更干净。

## [](#-que-es-mocking-)阙 es 嘲讽？

它是一个“双重测试”使我们能够伪造物品，函数使我们返回一个默认值，有几种类型的打闹，通常我们都用 Mock 一词涵盖它们，如果你想更详细地描述这些类型，我推荐你这篇文章。

在本帖子中，使用 pytest-mock 和 django-mock-queens 库对 django 进行模拟查询集，而忽略对数据库的访问，从而实现测试，测试不依赖数据库，并且只需几秒钟即可完成。

## [](#sabiendo-esto-que-testeamos)明知故犯，我们测试了吗？

通常，使用 DRF 开发 rest API 时应测试，
这些组件:

1.  序列化程序。
2.  查看。

除此之外，我们还必须加上框架中的一些共同内容，例如:

*   Helpers、UseCase、Services(在您的计算机上称为业务逻辑层)。
*   模型管理器方法。
*   模型方法。

后者应避免使用，因为模式只应用作
数据访问层，而不应用作业务逻辑层，正如我们在
开头时所述(包括我自己)，我们评论了使用的错误。

### [](#el-modelo)型号。

对于这个研究案例，我们将创建一个小型 rest API，用于管理我的个人车库，
，在这里我们将只有一个名为**的小型模型，因为**。