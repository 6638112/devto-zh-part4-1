# 分支和合并——第 1 部分——你应该这样做吗？

> 原文:[https://dev . to/jeastham 1993/branch-merging-part-1-should-you-do-it-m9j](https://dev.to/jeastham1993/branching-merging-part-1-should-you-do-it-m9j)

或者我在这个开发博客上的第一组文章，我实际上不打算直接谈论代码。相反，我将把注意力集中在源代码控制和所有与分支和合并相关的事情上。

我们都曾是开发人员——愉快地开发一个新功能，只为两件事之一:

1.  有一个重大的错误与生活的系统，你需要应用一个新的修补程序的权利这一秒钟。你对此无能为力，因为你正在开发一个新功能
2.  您意识到您已经更改了一些不应该更改的代码，但是无法在 IDE 中撤消，因为您已经关闭并重新打开了编辑器窗口

在我发现源代码控制之前，这真的让我很生气。

## [](#what-is-source-control)什么是源码控制？

首先，源代码(或版本)控制使您能够跟踪对代码的更改，并回滚/撤销您所做的任何不应该做的更改。它也是一个很棒的工具，允许多个开发人员协作并共享相同的代码库，而不需要在办公室内(或在当今的远程工作环境中在世界各地)传递 USB 驱动器。

那不就是魔术吗？

任何做过一定数量开发的人都会听说过 GitHub，并可能以某种形式偶然发现了它。GitHub 可能是最著名的源代码库。

我目前在我的组织中使用 Azure DevOps，它是基于 Git 的，所以我在这里谈论的相同命令/特性适用于许多源代码控制系统。

## [](#source-control-sounds-cool-but-what-is-branching)源码控制听起来很酷，但是什么是分支呢？

### [](#branching)分支

源代码管理解决了大部分(如果不是全部)由代码更改引起的问题。无论是错误地更改单元测试，使其失败，还是简单的类型。

然而，当多个不同的开发人员同时开发多个特性时，你该怎么办呢？一个单一版本的代码很快就变成了管理的噩梦。

你会很高兴知道，有一个答案！

在过去的 12 个月里，我对源代码管理的热爱呈指数级增长。主要原因？分支！

想象一下，当你正在开发应用程序的一个新功能时，突然需要一个紧急的补丁。你是做什么的？

即使有了一个基本的源代码控制系统，您仍然会被一些没有经过测试的部分提交的代码所困扰。这使得您的紧急修补程序停留在一些任意的新功能后面，可能需要几周才能发布。

这就是分支出现的原因。

分支允许开发团队在一个中央代码库中轻松协作。当开发人员创建一个分支时，版本控制系统在那个时间点创建代码库的副本。对分支的更改不会影响团队中的其他开发人员。
**丹·拉迪根——阿特兰西斯**

## [](#merging)合并

合并就是将两个分支重新合并在一起的过程。您将一个分支合并回另一个分支，在大多数情况下，这将是一个功能或修复分支，合并回一个更主要/更长期的分支。希望这几乎总是无缝的，但有时也会有令人头痛的问题。

合并冲突引起的头痛。

合并冲突是指两个或多个开发人员编辑了同一文件中的同一行代码。Git 非常擅长自己解决问题，但是有时需要一点点人工干预。

[![Alt Text](../Images/aad44509bb1ba70e6acd94420fc649d2.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--fYVYp5RL--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/4f7f41j8e3burojlicv1.png)

*   Visual Studio 代码中的合并错误*

这条信息，或者类似的信息，将成为你生活的祸根
有无数不同的分支和合并策略。在接下来的几篇文章中，我将重点介绍我最近在我的组织中试用的几种方法。

简单介绍一下，目前我们是一个两人团队。如果你是拥有 300 多个开发人员的微软，对分支和合并系统的要求可能没有那么高。

也就是说，我坚信应该为你想去的地方而不是你现在所在的地方建立一个系统。

## [](#git-flow)去流

GitFlow 是由 Vincent Driessen 首先提出的管理 Git 存储库的策略。它决定了应该如何以及何时创建新的代码分支，以及应该如何管理所述分支的合并。

[![Alt Text](../Images/d54ceaa04c32f6452ddc8edf6d516a1d.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--4rMQzI4X--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/j6rzt5lqflkvr2ohdsm5.png) 
图片取自 nvie.com

它包括新的功能分支、错误修复和任何新版本。“主”分支总是与当前生产中运行的软件的确切版本保持同步。开发分支总是保持运行，任何新的开发工作都从这里开始。

## [](#release-flow)释放流量

发布流是微软的分支、合并和发布模型。这是我最近才偶然发现的，我真的很喜欢它的简单。你可以在这里了解更多。

基本上，一个“主”分支一直保持运行。不管新代码是什么(特性或修补程序)，它都是从主代码分支而来的。

主版本应该始终是干净的、可构建的和可测试的，但不一定是发布就绪的。

开发人员为他们正在做的工作创建一个新的分支，完成工作，然后推回到存储库。

然后，通过 pull 请求将代码合并回主分支。简单地说，拉请求允许控制代码的合并。可以制定规则来控制谁可以提交。甚至可以启动构建管道来预合并变更并运行一系列测试。

一旦一个版本准备好了，一个新的分支就会从主版本中创建出来，并有一个合理的名称(release/v1.0.1)。然后将其推向生产。

一旦没有系统仍在使用旧版本，该分支就可以被删除或归档。

简单吧？

## [](#should-you-use-branching-and-merging)该不该用分支合并？

即使你是一个单独的开发人员，从事你自己的个人项目，习惯分支和合并也是对你技能的一个很好的补充。

当创建新分支的命令简单到

 `git checkout -b feature/mynewfeature` 

那么谁能真正决定这不是一个好主意。

在接下来的几篇文章中，我将更深入地研究 GitFlow 和 Release Flow，并给出我对两者利弊的看法。