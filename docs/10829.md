# 适合你我的 Xpath

> 原文:[https://dev.to/jenniferlynparsons/xpath-for-you-and-me-15mi](https://dev.to/jenniferlynparsons/xpath-for-you-and-me-15mi)

几年前我学习了 XPath，总是发现自己对它的文档感到沮丧。在我学习的过程中，有几个基本概念似乎让我犯了错误。我希望这篇简短的文章能让下一个需要学习这个小而强大的工具的人更容易理解。

## XPath 是什么？

XPath 代表 XML 路径语言

XPath 被设计用来指向 XML 文档的各个部分。我们用它来做 DOM 节点之间的模式匹配。它用于 XSLT、Selenium 和其他需要 DOM 导航的领域。

当查看 xpath 查询的语法时，将它视为我们正在导航的文件层次结构，类似于 URL 路径。从直觉上来说，这样更有意义。每个父元素都是一个“文件夹”，可以包含其他文件夹(子元素)。

一般语法也类似于正则表达式和 CSS 选择器。

## [](#xpath-query-structure)XPath 查询结构

XPath 查询由四部分组成。

*   前缀决定了查询的起点。
*   轴指的是上下文节点的关系。
*   步骤也是上下文节点，是我们所引用的元素的标识符。
*   谓词使步骤更加具体

**注意:【XPath 查询越不具体，性能就越昂贵。类似于 CSS 选择器，在特异性与灵活性和性能之间有一个平衡。**

| XPath 查询的一部分 |
| // | 保险商实验所 | / | 一个[ [@id](https://dev.to/id) ='link'] |
| 前缀 | 步骤 | 轴 | 带谓词的步骤 |

### [](#axis-selector-examples)轴选择器示例

轴选择器允许我们“深入”我们正在处理的结构，以访问我们正在寻找的节点。

| 轴选择器 | 例子 | 语境 |
| --- | --- | --- |
| `//` | `/section/div//a` | 前缀时在文档中的任意位置(这会将上下文设置为任何派生元素) |
| `./` | `./a` | 相对于当前节点的子节点 |
| `/` | `/html/body/div` | 从根开始(这也将选择任何子元素的上下文) |
| `.` | `.` | 自身节点 |
| `..` | `..` | 亲代交点 |
| `*` | `./*` | 任何节点 |

## [](#navigation)导航

XPath 还允许在 DOM 的层次结构中上下导航，就像文件夹导航一样。

选择器可以是链式的，可以包含一些有限的逻辑。它们基于各种模式匹配标准，类似于正则表达式。

*   关系(子代、兄弟姐妹、前一个、自身)
*   属性(id、类名、href)
*   顺序(名字，姓氏)
*   内容(包含字符串“xyz”)

### [](#selector-examples)选择器示例

| 例子 | 语境 |
| --- | --- |
| `//ul/li/a` | 关系选择器，匹配直接子关系 |
| `//input[@type="submit"]` | 属性选择器 |
| `//ul/li[2]` | 订单选择器，选择第二胎`<li>`。注意:这不是零索引。 |
| `//button[contains(text(),"Go")]` | 包含文本，在这种情况下匹配子字符串 |
| `//a[@name or @href]` | 或者逻辑 |
| `//ul/li/../../.` | 选择`<ul>`的父项(例如，`<div><ul><li> </li></ul></div>`结构) |
| `//h1[not(@id)]` | 不是选择器。本例选择任何没有 id 的`<h1>` |
| `./a[1][@href='/']` | 链式的例子。这里我们选择当前上下文中的第一个`<a href=”/”>` |

关于`contains()`的一个笔记。这个选择器相当松散，将选择任何包含传递给它的字符串参数的字符串。这可能导致意想不到的结果。在上面的例子中，任何带有字符串`Go`的按钮都将被选中，在这种情况下`Go Home`和`Go to Next Page`都将被选中。组合各种选择器可以产生您想要的结果。

## [](#resources)资源

MDN
T1】https://developer.mozilla.org/en-US/docs/Web/XPath

提示。我
[https://提示。io/xpath](https://devhints.io/xpath)

Scrapy 文档
[https://doc . scrapy . org/en/XPath-tutorial/topics/XPath-tutorial . html](https://doc.scrapy.org/en/xpath-tutorial/topics/xpath-tutorial.html)