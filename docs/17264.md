# 处理合并

> 原文：<https://dev.to/jessekphillips/handling-merges-464d>

合并代码可能很有挑战性，而且也不好玩。Git 将使用许多算法来识别如何按照预期的方式进行更改。然而，这并不总是可能的。

我想回顾一下我看到的一些挑战，我如何处理合并冲突，以及如何避免它们。

# 合并工具

有一些非常好的合并工具。还有一些方法有效，但会让事情变得更难。

个人选择的编辑器是 vim，我开始喜欢上了 [diffconflicts](https://github.com/whiteinge/diffconflicts/blob/master/README.md) ，因为我得到了自动合并和关注冲突的好处。

Beyond Compare 是我想到的另一个好工具。Kdiff 是我用过的最差的工具，所以也许可以看看 meld。

# 提交

我发现处理合并冲突的一个最重要的方面是让 sain 提交对最终结果的明确预期。如果你的提交是“让事情变得更好”,并且处理了重构、性能和修复了一个 bug，那么在面对冲突时很难确定什么是需要的。

这在另一方面也是有益的，当你与另一个变化冲突时，一个别人可能有你从未见过的作者。对于较小的提交，理解他们的工作很容易。

# 冲突

## Rebase

这是我的心理模型有一点错误的地方，也是我写这篇文章的原因。

[![jessekphillips image](img/31858bd0e6e4624513209d6afd21d614.png)](/jessekphillips) [## Git 保存快照，其实不是

### 杰西·菲利普斯 12 月 15 日 181 分钟阅读

#git](/jessekphillips/git-saves-snapshots-well-not-really--2bkc)

人们一直强调这种快照心理模型的原因与冲突有关。我不想传播不正确的信息，但这是迄今为止我所看到的事情的最好解释。

Git 会在文件上发生冲突，这意味着只从一个分支更改的文件不会发生冲突。但这也意味着它将在提交更改之外发生冲突，并识别所有文件差异。因为我认为这是一个奇怪的行为，可能有一些启发在起作用，也许我误解了我的一些冲突。

我建议研究 rebase 的 rerere 选项。我还需要用它来做解说。

## 合并

有人告诉我，merge 不关心提交，只是改变最终状态。这可能与 rebase per commit 中发生的情况相同。只是在 rebase 中，我认为是“改变”,而 git 认为是快照。

# 避免冲突

真正的方法只有一个，不要在不同的分支上更改同一个文件。

然而，有一些技术可以帮助减少冲突的可能性，你可能听说过，持续集成。这个术语是超载的，但它的核心是致力于一个共享的主线，一个有最新主线更新的工作。

Git 提供 rebase 作为一种跟上主线的方式。冲突是会发生的，但是如果你有一个文件的最新变更，你至少可以避免一个冲突。

记住，你越早做出改变，就越有可能有其他人来处理这个冲突，你给他们一个机会在冲突发生前阻止它。

# 简化冲突

有时，当重新调整以保持最新时，您还没有清除提交历史，现在不是这样做的时候。如果您有太多的提交，那么有必要考虑`git rebase --abort`并首先清除原始分支上的历史。

不包括某些提交也可能是有意义的，希望您已经推动了孤立的更改，但实际上并不总是这样。所以找到你以后要处理的冲突，放到另一个分支。

我对提交进行了大量的重新排序，这可能会在相同的历史中产生冲突，请务必在合并工作之前处理这些冲突。

放弃，全部压扁。有时，一次性处理它会更容易，您可以在 rebase 完成后分解提交。

如果你在修复某个东西之前先折射，那么先把重构合并进来，在重构之前修复问题，或者不折射，它可能不值得保留。

# 结论

所有这些都依赖于理解什么在变化。如果你在编程时不断地修改，直到它正常工作，但却不明白为什么，那么冲突将会困扰你。如果你遵循了我的建议，那么学习合并才刚刚开始。

# 晋升

如果你喜欢这篇文章，请跟我来。看看我的简介，看看你是否喜欢我的其他作品。我涵盖了 git、测试、D 等等。