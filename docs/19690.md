# 为什么要构建一个包？

> 原文:[https://dev.to/chrisrhymes/why-build-a-package-3amm](https://dev.to/chrisrhymes/why-build-a-package-3amm)

在我的日常工作中，我使用了大量的软件包。这让我想到创建自己的包会很好，所以我决定构建一个 Laravel 包。在它准备好之前还有很长的路要走，但是我想我应该趁它还在我的脑海中的时候写下我对构建一个包的好处的想法。

## [](#what-is-a-package)什么是套餐？

让我们从定义什么是包开始。这是我如何定义一个包的，因为我在任何地方都看不到一个包的官方定义。

> 一个或多个独立的、可移植的功能，可以导入到项目中使用。
> 
> –<cite>克里斯押韵</cite>

这听起来既准确又模糊。如果有人找到了官方定义，请告诉我，因为我有兴趣阅读它。软件包可以是各种各样的，小到格式化日期，大到允许你使用 twitter 帐户登录你的 web 应用程序。许多包甚至在内部使用其他包，这些被称为依赖。

## [](#why-separate-out-the-code-into-a-package)为什么要把代码单独出来放到一个包里？

现在我们对包有了更多的了解，为什么要构建一个包呢？我目前正在开发一个 Laravel 包，有一些关键的原因可以解释为什么包比直接将代码写入一个新的 Laravel 项目要好。

对于这个例子，我想创建一种方法，用数据库中存储的一些文本内容编写一个简单的页面。

我从一个全新的 Laravel 安装开始，然后直接在项目中创建模型、视图和控制器，就像我处理任何其他项目一样。我创建一个模型来访问表中的页面内容，我创建一个控制器来存储和更新页面内容，然后我为用户界面创建视图。

但是后来我考虑到我可能想在另一个项目中再次使用它，这个项目也需要一些简单的文本页面。这很好，我可以将模型、视图和控制器从项目 A 复制并粘贴到项目 b 中。

但是如果我在另一个项目中需要它呢？然后我必须将代码从 A 复制到 B，再复制到 c。

所以现在我有三个项目使用相同的代码。这只是可管理的，但是我想到了一个可以添加到项目 C 中的新特性，所以我直接在项目 C 中编写了这个特性，但是我认为项目 A 需要它，所以我把它复制到项目 A 中。

然后我在项目 B 上多做了一点工作，发现控制器有一个 bug。我修复了 B 中的错误，然后尝试将该修复应用于 A 和 C，但是它们有一个带有附加功能的更新版本的控制器，所以错误修复在这些情况下不起作用。

希望你现在能明白这不是一个好地方。

编写一个包允许我们从项目中提取功能并拥有一个主版本。然后，您可以更新主版本，并将更新应用到您的所有项目中，希望使用类似 composer 的东西来为您完成所有困难的工作。

## [](#defining-versions-of-your-package)定义您的包的版本

它作为一个包的另一个好处是你可以创建版本。您可以开发一个包，并将所有内容存储在 git 的主分支中，但这意味着每次您更新项目时，它将始终使用您的包的最新版本，这可能包含一个尚未完全测试的特性，并可能破坏使用您的包的旧版本的项目。

您可以在包 repo 中使用 git 标记将特定的提交指定为一个版本，然后在每个项目的 composer.json 文件中定义您需要的版本。

然后，您可以在项目 A 和 B 中安装版本 1，但在项目 c 中安装版本 2。版本 2 中任何潜在的重大更改都不会影响项目 A 和 B。

## Laravel 使得开始构建一个包变得容易

我很担心开始为 Laravel 构建一个包，但事实证明包有很好的内置支持。如果你查看了 [Laravel 文档](https://laravel.com/docs/5.8/packages)，那么有一个页面专门用于构建 Laravel 包。您期望的所有功能都是开箱即用的，例如创建配置文件、数据库迁移、路由、视图，甚至发布前端资产。

我鼓励你完整地阅读文档页面，但是大部分的设置是由你的软件包服务提供商完成的。您可以在 packages composer.json 的 extras 部分定义服务提供者和 facades，这样就可以工作了。

```
"extra": {
    "laravel": {
        "providers": [
            "ChrisRhymes\\MyPackage\\ServiceProvider"
        ],
        "aliases": {
            "MyPackage": "ChrisRhymes\\MyPackage\\Facade"
        }
    }
}, 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

## [](#laravel-package-development-tip)Laravel 包开发提示

我发现让开发变得简单一点的一件事是在 Laravel 安装中将您的存储库定义为 url，然后像往常一样将其添加到 require 部分。

```
"repositories": [
    {
        "type": "path",
        "url": "../my-package"
    }
], 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

这样你就可以在 Laravel 安装之外的一个文件夹中开发它，而不需要一直把你的代码推到 github、gitlab 或者 bitbucket，也不需要一直做 composer 更新来获得最新版本。

祝你的软件包开发好运，希望我也能很快推出我的。