# 更好的代码审查。

> 原文:[https://dev.to/psyked/better-code-reviews-5b28](https://dev.to/psyked/better-code-reviews-5b28)

## [](#reducing-fear-and-friction-in-the-review-process)减少复习过程中的恐惧和摩擦。

代码审查是开发软件的重要部分。这可能是最具挑战性的部分之一，因为它涉及到锻炼编写代码所不需要的技能，比如外交手腕、机智和判断力。

[![](../Images/22059f8ef2cba313f419c6eb6e991235.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--bOgArl2X--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2656/1%2Ae_GcUPHFZitEAn0DUrp7FA.png)

可以用代码解决的问题可能只有一个正确的解决方案，但是这个解决方案可以用许多不同的方式编写。许多不同的方式满足其他不成文的标准，如执行时间、重用能力、简单性、可理解性、可移植性和一致性。

[测试驱动开发(TDD)](https://en.wikipedia.org/wiki/Test-driven_development) 过程使检查问题的技术解决方案变得更简单，因为它强调在实际编写任何代码之前识别要解决的问题和验证解决方案技术准确性的方法。但是当我们执行代码审查时，我们寻找的不仅仅是问题的解决方案，因为验证是布尔型的——测试要么通过，要么失败。

代码评审不是关于解决方案，而是关于灰色的阴影，以及应用软件开发的不成文的规则。

### [](#unwritten-rules)不成文的规定

> 拥有不成文的软件开发规则是一件坏事。

技术解决方案很好，因为它们准确、精确，而且所有方面都可以量化。人员解决方案很复杂，因为它们是其他一切。

[![](../Images/f913658e559df0b236858b9de640b167.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--jOCsmQWt--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2680/1%2AZHwn8cArmOGrRm485LZldw.png)

代码评审是指另一个人来看你写的代码，并挑出它的缺陷。也许你写的代码太复杂，也许太简单。也许你的变量名与代码库的其他部分不一致，或者它不够面向对象或者不够 T2 功能。也许，也许，也许。

这就是代码审查的麻烦所在——它们可能是主观的，审查不一致，或者基于不可预测的标准。

### [](#dont-stop-reviewing)不要停止复习！

我们不应该废除代码审查。代码评审是维护团队一致性和共同理解的一个很好的工具。代码评审是软件开发的重要部分，应该全方位进行——低年级评审高年级，反之亦然。

[![](../Images/4323e3bcddb0a8f0b41175432fdad596.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--7lSdDF4A--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2740/1%2Aybbr-iq5zv6LiTnOtGnzng.png)

但是代码审查很容易让人感觉像人身攻击，这就是为什么我们有像 [Prime Directive](https://retrospectivewiki.org/index.php?title=The_Prime_Directive) 这样的东西:

> 不管我们发现了什么，我们理解并真诚地相信每个人都尽了最大努力，考虑到他们当时所知道的、他们的技能和能力、可用的资源以及手头的情况。— [诺姆·克思](http://www.retrospectives.com/pages/retroPrimeDirective.html)

我们无法控制人类。我们可以鼓励更好的行为，并更加关注评审过程中提供的反馈，但对于评审者和被评审者来说，这总是主观的。

更好地进行代码评审的部分答案可能在于从过程中移除未知的标准——或者通过将评审注释限制在原始任务中指定的标准，或者通过扩大任务定义的范围以包括评估解决方案的所有可能方式。

### [](#restricting-feedback)限制反馈

在评估过程中限制反馈不是一种可能带来长期快乐和团队满足感的方法。评论是工程师表达想法的机会，在一个地方审查反馈只会让它在另一个渠道再次出现。将讨论局限于特定的主题往往会导致一系列无休止的不连贯的对话，分散了对产生这些问题的原始问题的注意力。

### [](#broader-acceptance-criteria)更广泛的接受标准

更广泛的标准可以减少代码审查中令人惊讶的元素，但是它可能很快变得对解决问题的方式过于规范，而不是定义一个可接受的解决方案是什么样子。不仅如此，将任务的标准扩展到包括可接受代码的所有可能措施，会有为工程师创建不可能完成的任务的风险——解决问题变得太令人生畏，达到某些标准的可行性在开始时可能是未知的或不可能满足的，或者当更简单的解决方案就足够了时，提议的解决方案是过度设计的和不必要的复杂。

[![](../Images/58718679911bc9a5a7d6b88f19ade352.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--OjI3xECR--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2732/1%2ABtyDT7fENtRa5D-SmwS_fw.png)

使代码评审变得更好的挑战的最佳解决方案可能与什么样的政策或过程实际上被放在适当的位置来促进它们无关。技术解决方案是二元的——可以工作，也可以不工作——但是工程师的意见和经验各不相同，导致评审中的结果和质量标准不可预测。

代码审查必须是有机的，因为这是开发团队所有成员的机会，在代码最终确定之前，对彼此的代码进行监督和提供输入。这是每个人学习的机会，也是团队对其他任务的未来方向做出集体决策的机会。

## [](#the-problem-with-code-reviews)代码评审的问题

采用有机方法进行代码评审的问题在于，它似乎鼓励纯粹的功能性注释，只关注需要改变的东西，而不是好的元素。

[![](../Images/2a658c2e577f4e091369f35f9210423c.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--onmKKtb6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2204/1%2A2bcWexIZDKKmyIan9T1QHA.png)

如果代码评审仅仅是为了突出缺点，那么总体结果是负面的。它也应该有一些积极的方面。只关注不好的因素，以及认为需要改变的地方，只会突出和加剧团队中任何潜在的分歧。这很糟糕。不管一篇评论是多么善意，它都可能被视为人身攻击。我们是人，我们会对攻击做出情绪化的反应，不恰当的负面评论会播下异议的种子，并可能强化年龄、经验、性别、资历、组织结构、文化或个性方面的任何潜在差异。

我很幸运，因为我是一个中年白人男性，在技术行业工作，我有多年的开发经验，我是我团队的技术主管，我熟悉我的代码库。当有人审查我的代码时，我不应该有理由感到被攻击，我也没有骗子综合症的潜在感觉或告诉我这个行业不适合我的声音。但是并不是每个人都有这些奢侈的背景，甚至当我的代码被负面评价时，我也会感到情绪激动。

### [](#be-kind)为人和善。

底线是，要友善。要有礼貌，要有外交手腕，对积极和消极的方面都要给出反馈——不一定要列出要完成的可操作的任务，把它当作一次回顾，而不是吹毛求疵的练习。作为一个团队，你正在努力创造一个共同的理解和统一的代码库。相应地对待您的代码评审。

## [](#code-review-checklist)代码评审检查表

我不认为过程或工作方式的任何改变可以强制更好的代码审查。代码审查是人类驱动的开发部分，因此依赖于人类的行为。鼓励行为的最佳方式是引导他们，为了帮助我引导他们，我按照一个(非正式的)清单，这是我为自己准备的，如下所示:

*   这个人以前贡献过代码吗？

*   他们是否以团队期望的方式做出贡献？

*   自动化测试通过了吗？

*   是否添加了新的自动化测试？

*   这段代码有什么不好？

*   这段代码有什么好处？

*   有哪些非关键但值得考虑的扩展？

*   代码生产准备好了吗？

*   如果我们面对面，我还能说什么？

[![](../Images/745fe0a39503dbad84853e0bcbcb0fb5.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--nSTPslQ6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/2458/1%2AlVJzlGMYp6Jzn6AM3igZKA.png)

仅此而已。恐怕没有什么神奇的公式，只是做一个更好的人。

插图由 [unDraw](https://undraw.co/) 提供