# 如何清理我的树枝？

> 原文:[https://dev . to/tomaszprasolek/how-to-clean-up-my-branches-2 lgp](https://dev.to/tomaszprasolek/how-to-clean-up-my-branches-2lgp)

你显示分支列表，你不知道发生了什么。名单上有 10 多个分支机构。你读着他们的名字，却不知道是什么。你会想，“这是我的树枝吗？”你看了一遍，你看了最后的提交，你可以看到它是你的。一些分支是两个月前的，他们有一个来自已经生产了很长时间的任务的代码。

你有这样的情况吗？在这篇文章中，我将向你展示如何清理树枝。

### [](#local-and-remote-branches)本地和远程分支机构

GIT 中使用分支的一种更常见的类型是 GitFlow 或它的一些变体。简而言之，重点是我们在新分支上做的所有新特性和错误修复。在完成工作之后，我们将这些分支与我们的主要开发分支合并(或者重新构建基础)。有时候是`develop`，有时候是`master`——这要看队里的安排。

正如我上面提到的，如果我们做了一个小特性或者修复了一个小 bug，那么通常我们会为它创建一个新的分支。在完成工作之后——如果我们不到一个工作日就完成了——我们将我们的变更合并到开发分支中，并删除这个本地分支。

然而，有时我们不得不把任务留到第二天。然后把我们的分支推送到服务器上，拥有我们工作的副本，这是一个好习惯。完成工作后的第二天，我们当然必须将我们的工作与主分支合并，然后删除本地分支和远程分支。

随着时间的推移，如果我们不定期删除它们，分支列表可能会变得更大。

但是，如何检查哪些分支已经和主分支合并了呢？

```
git branch --merged 
```

该命令将显示已经合并的分支列表，即那些将要被删除的分支。

如果我们对尚未合并的分支感到好奇，那么我们将使用命令:
显示它们

```
git branch --no-merged 
```

潜在地，如果我们知道这是一些不必要的分支，例如，我们只测试了一些代码，这样的分支也可以被删除。

### [](#deleting-the-branches)删除分支

删除已经与主分支合并的分支:

```
git branch -d <branch_name> 
```

如果分支没有被合并，信息将显示在控制台上。要删除这样的分支，您需要使用命令:

```
git branch -D <branch_name> 
```

以上命令相当于:

```
git branch --delete --force <branch_name> 
```

从服务器删除远程分支:

```
git push -d origin <branch_name> 
```

### git-策展工具

您可以使用 [git-curate](https://github.com/matt-harvey/git_curate) 工具清理您的本地分支。是用 Ruby 写的工具。运行后，它会显示每个本地分支及其信息:

*   上次提交的日期。
*   最后一条提交消息。
*   它是否被合并到头中的信息。
*   它是否有远程分支的信息。

在每个分支，你可以决定如何处理这个分支。如果您输入:

*   `y` -将标记要移除的分支。
*   `n` -将标记分支，不删除它。
*   `done` -将移除所有先前标记为删除的分支并关闭程序。
*   `abort` -将关闭程序而不做任何动作。
*   `help` -将显示帮助。

如果我们在分支中进行更大规模的清理，git-curate 工具将会加速这个过程。

### [](#delete-refs-to-remote-branches)删除对远程分支机构的引用

也有几个人在同一个部门工作的情况。有时候我们下载某人的分支，是因为这个人有问题找我们帮忙。

完成工作后，我们删除本地分支机构。我们帮助的人移除了本地分支和服务器上的分支。

是不是说没有这个分支的痕迹了？不完全是。仍然存在对远程分支的引用。输入命令
后，这将是可见的

```
git branch -a 
```

远程分支机构的名称将以`remotes/origin/`开头。例如，分支`feature`的远程分支将具有名称:

```
remotes/origin/feature 
```

如何删除对远程分支的引用？只需输入命令:

```
git fetch --prune 
```

该命令删除对服务器上不再存在的分支的所有引用。

这样的引用仍然存在，因为 Git 不是一个典型的在线工具。如果有人删除了我们曾经下载的服务器上的 branch，它不会在我们的本地存储库中被自动删除。因此，偶尔使用上面的命令是有好处的。

### [](#summary)总结

记住立即删除本地和远程分支(如果有)。两个命令就足够了:

删除本地分支:

```
git branch -d <branch_name>
git branch -D <branch_name> # enforcing deletion of the branch 
```

远程分支移除:

```
git push -d origin <branch_name> 
```

要删除对已经不存在的分支的引用，命令是:

```
git fetch - prune 
```

我希望你定期清理树枝。如果没有，我指望你从现在开始。

* * *

我来自波兰，英语不是我的第一语言。这是我第一篇用英语写的帖子，所以如果文本中有一些错误，请告诉我:-)