# SwiftUI 的第一想法

> 原文:[https://dev.to/trozware/swiftui-first-thoughts-cno](https://dev.to/trozware/swiftui-first-thoughts-cno)

在 WWDC 2019 上，苹果宣布了一个全新的声明式 UI 框架，名为 [SwiftUI](https://developer.apple.com/xcode/swiftui/) ，让我们所有人都感到惊讶。引用苹果公告中的片段，“SwiftUI 是一种创新的、非常简单的方式，利用 Swift 的力量在所有苹果平台上构建用户界面”，以及“SwiftUI 使用声明性语法，因此您可以简单地陈述您的用户界面应该做什么。”但这意味着什么，我们现在是否都应该采纳它？

[![Swift](../Images/66a8d3bc9ed2d402a86100a3a3929023.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--M84z7kx4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://developer.apple.com/assets/elements/icons/swift/swift-96x96_2x.png)

## [](#swift)雨燕

在讨论是否采用 SwiftUI 之前，我们需要考虑 Swift 本身，因为没有 Swift 就无法使用 SwiftUI。

Swift 在 2014 年 WWDC 上的发布完全是一颗重磅炸弹。在澳大利亚，我每年都在半睡半醒的时候看主题演讲，因为它从凌晨 3 点开始。那个通告让我完全清醒了，兴奋地从座位上跳了起来。我是早期采用者，从未后悔过那个决定。

许多备受尊敬的开发人员决定忽略 Swift，他们有各种各样的理由，所以让我们来看看我听到的理由:

#### [](#1-im-very-comfortable-and-productive-in-objectivec)1。我在 Objective-C 中非常自在且富有成效

这是一个不错的理由，对许多人来说，他们的雇主可能会坚持使用这种语言，但这个理由对我不起作用。首先，我认为永远不会有一种完美的语言(向[克里斯·拉特纳](https://oleb.net/blog/2017/06/chris-lattner-wwdc-swift-panel/#in-which-fields-would-you-like-to-see-swift-in-the-future)道歉)，所以我总是乐于接受新的想法。就我个人而言，我喜欢学习新的语言，即使我永远不会在生产中使用它们。我觉得这让我成为一个更好的程序员。Swift 有很多好处——它是一种更安全的语言，读起来更容易，写起来更简洁，它只是一种更现代的语言。

#### [](#2-swift-is-too-new-and-changes-too-much-between-versions)2。Swift 太新，版本之间变化太大

斯威夫特是新人。它现在已经有 5 年的历史了，我们已经进入了 5.2 版本。不可否认的是，从 1.0 开始有了很多变化，其中很多是突破性的变化。Swift 3 在这方面尤其糟糕。但这也带来了好处。作为早期采用者，我们能够影响语言的方向。Xcode 总是很好地提供下一版本的转换器。但无论如何，自 Swift 4 以来，不应该再有突破性的变化，所以这是一个已经过时的论点。

#### [](#3-no-abi-stability)3。没有 ABI 稳定性

ABI 的稳定是许多人紧握的拐杖，作为避免 Swift 的借口。但是，除非你是在为分销建立框架，否则我不认为它是一个完全的交易破坏者。Swift ABI 稳定宣言对什么是 ABI 稳定以及它将允许什么有一个很好的回顾。作为应用程序开发人员，主要优势是 Swift 库将不再需要与每个应用程序捆绑在一起。这将大大减少应用程序的大小。但不管怎样，我们现在有了 ABI 的稳定，所以这个争论结束了。

#### [](#4-apple-may-not-be-serious-about-swift-and-it-may-not-last)4。苹果可能不会认真对待 Swift，也可能不会长久

我认为这里有一些一厢情愿的想法。这一理论背后的主要数据似乎是，很少有苹果应用程序包含任何 Swift。一开始这是真的。我预计苹果的应用程序比独立公司的应用程序有更长的开发时间。然而，在过去几年里，越来越多的苹果自己的应用程序已经开始使用 Swift，无论是全部还是部分。任何关于苹果对 Swift 承诺的疑问都应该随着 SwiftUI 的发布而永久平息。

#### [](#5-its-too-complicated)5。太复杂了

好吧，这个有一些有效性，但话说回来，如果 Swift 要统治世界，它需要能够做很多事情。我喜欢 Swift，我喜欢用它写作，使用它的时候我很有效率。但是当我看到一大块代码中散布着泛型和不安全的指针时，我完全看不懂。然而，我认为，如果你正在编写任何标准的、非街机游戏的应用程序，你可以只用基本的东西就能写出非常好的 Swift。

## [](#why-did-apple-make-swiftui)苹果为什么要做 SwiftUI？

推翻了反对使用 Swift 的论点之后，是时候继续讨论 SwiftUI 了。让我们从为什么会发生这样的事情开始。

苹果现在有 5 个或者可能 6 个用户平台:macOS，iOS，iPadOS，tvOS，watchOS，也许还有 CarPlay。(我从来没有考虑过任何 CarPlay 开发，所以我不知道它是如何工作的。)屏幕尺寸从最小的手表的 38 毫米到超过 75 英寸的大屏幕电视(很抱歉把我的单位混在一起，但似乎电视还没有公制)。至于用户界面框架，我们已经有了 AppKit、UIKit 和 WatchKit。AppKit 是这个团队中受人尊敬的老成员，是 NextStep 的后代(这就是为什么每个元素名称都有 NS 前缀)，用于制作 macOS 应用程序。UIKit 是为 iPhone 从头开始构建的，因此比 AppKit 更新更简洁，但同时也更受限制。它从来不需要处理 Mac 应用程序界面的巨大可变性和复杂性。WatchKit 是一个更加精简的框架，界面元素相对较少。

现在假设你正在尝试编写一个多平台的应用程序。你必须学会至少三种不同的做事方法。总有一些差异让我困惑。例如，在 AppKit 中，要设置文本字段中的文本，您需要设置字段的`stringValue`，但是在 iOS 中，您可以设置字段的`text`属性。在 WatchKit 中，你调用`setText()`方法。

想要更改视图的背景颜色？UIView -没问题，设置`backgroundColor`。不，用图层做些奇怪的事情。我忘了是什么，每次都要查。

这些不一致令人讨厌、耗时，并且是跨平台开发的巨大障碍。当我读到假设 Swift 编程= iOS 编程的文章或推文时，这真的让我很恼火，因为它实际上要多得多。但是在 SwiftUI 之前，在平台之间跳转并不容易。

先前代号为杏仁糖的催化剂被认为是答案。而且是部分答案。它允许将 iPad 应用程序移植到 Mac 电脑上，这对于想要拓展业务范围的 iPad 开发者来说是个好消息。但这并不是所有人的答案。

### [](#interface-builder)界面构建器

在我深入了解 SwiftUI 的优点之前，我想花点时间讨论一下 Interface Builder。Xcode 是一款出色的工具，每发布一次都会变得更好，但它的弱点一直是界面构建器。我已经足够大了，还记得 Interface Builder 是一个独立的应用程序的时候(那时候我们并不称之为“应用程序”)，尽管它已经被合并到 Xcode 中很多年了，但界面和代码之间的连接一直很笨拙，不直观。控制-从界面拖动到代码，然后记住在动作和出口之间切换，这样你就不会把你的按钮命名为“doneButtonWasTapped”。如果你把修饰键弄错了，谁知道会发生什么奇怪的事情。

然后是自动布局…它比老派的 springs & struts 灵活得多，随着 iPhone 和 iPad 型号的不断增加，必须做一些事情，但是如果你从来没有咒骂过自动布局并返回到以前的提交或反复混合撤销，那么你就不会经常使用自动布局！

WatchKit 有一种完全不同的布局方式，简单、直观、令人耳目一新。你拖动物体，它们一个接一个地移动。你可以将它们水平或垂直分组，你可以将它们做成表格单元格。WatchKit 需要处理的界面元素和设备尺寸更加有限，但我认为我们可以从 SwiftUI 的工作方式中清楚地看到它的起源。即使您仍然需要使用界面构建器来完成这项工作。

Interface Builder 的怪癖导致了一类程序员，他们觉得需要用代码编写所有的界面。在我看来，这是一个巨大的时间浪费，你仍然不得不与自动布局搏斗，但没有视觉线索！但是如果这能让他们开心…

[![SwiftUI](../Images/353c1cb5c13eb2bc91b5c88211d95dde.png)T2】](https://developer.apple.com/xcode/swiftui/)

## [](#what-is-swiftui)什么是 SwiftUI？

“声明式 UI 框架”——这是什么意思？基本上，声明式编程是一种指定程序应该做什么的方式，而不是指定如何做。一个常见的例子是做三明治。如果你想要一个三明治，你对三明治制作者说，“请给我一个火腿、奶酪和西红柿三明治”。你不会说"拿两片面包，都涂上黄油，切 3 片火腿和 2 片奶酪……"他们知道如何做三明治，所以你只需要开口要你想要的。

回到苹果 UI 世界，如果你想要一个按钮呢？是为了一个 iPhone 应用吗？然后你需要一个特定类型的 UIButton。设置其标题、大小、位置、布局限制。iPhone 按钮的默认大小是多少？默认字体是什么？文本应该是什么颜色？现在做一个 tvOS app 的按钮？那一定很大！还有它还有什么其他设置？但问题是，iOS，macOS，tvOS 等等。已经**知道**他们的按钮应该是什么样子。那么为什么不直接告诉系统“我想要一个按钮”呢？让系统解决细节问题，然后你就可以继续开发很酷的应用了。

我不打算把这篇文章变成 SwiftUI 教程，但我想感谢和推荐那些真正帮助我掌握它的人，特别是 [Paul Hudson 的 Hacking with Swift 和他的 Learn SwiftUI 教程](https://www.hackingwithswift.com/articles/196/learn-swiftui-with-free-tutorials)、 [Mohammad Azam 的伟大 YouTube 系列](https://www.youtube.com/user/azamsharp/videos)和 [Meng To 的 SwiftUI 课程 Design+Code](https://designcode.io/swiftui-course) 。

SwiftUI 的另一个巨大好处是，当与 Combine 框架一起使用时，它为您提供了一个反应式界面。有各种各样的第三方库可以做到这一点:RxSwift、ReactiveSwift、ReactiveCocoa、Bond 等，但通过 Combine，苹果将它融入到生态系统中，这使得它更容易设置，也意味着它将与操作系统保持同步。在反应式界面中，您可以将 UI 元素绑定到一段数据，然后当数据发生变化时，用户界面会自动更新。您甚至可以绑定两种方式，这样用户界面就可以更新数据，而无需您做任何事情。想象一下这能消除多少锅炉板代码？

## [](#the-good-the-bad-and-the-ugly)好人、坏人、丑人

### [](#1-the-good)1。好人

你可以用很少的代码得到很多的接口。制作表格是一种乐趣，不需要设置数据源和代理所需的大量样板代码。画布中的即时预览使迭代变得更加容易。能够创建类似 Picker 的东西，并让 SwiftUI 根据平台以多种不同风格中的一种来呈现它是不可思议的。

### [](#2-the-bad)2。坏事

现在还为时尚早，SwiftUI 还存在一些问题和缺陷。有时画布停止响应，在画布中切换到实时模式可能需要一段时间，当然它仍处于测试阶段，所以将会有突破性的变化。

### [](#3-the-ugly)3。丑陋的

很容易建立起死亡金字塔，在那里你有多层嵌套，导致你的代码的结尾是一串看起来无穷无尽的花括号。在 SwiftUI 中，人们倾向于从内向外构建:制作一个文本视图，将其嵌入到 VStack 中，以便您可以添加另一个视图，将该堆栈嵌入到 HStack 中，以便您可以添加图像等等……但有一个答案:按住 Command 键单击您的一个外层，然后选择“提取子视图”。

## [](#coding-the-layout)编码布局

在文章的前面，我谈到了程序员忽略接口构建器，用代码设计接口。我不认为这是一个好的方法，那么 SwiftUI 有什么不同呢？首先，你可以得到你正在编写的 UI 的即时反馈，所以你不会失去使用界面构建器的视觉优势。其次，SwiftUI 为您完成了大部分布局，因此您不必手工编写自动布局或每个 UI 元素的每个细节。所以就 SwiftUI 而言，我倾向于程序化布局。但是如果不使用 SwiftUI，我仍然会坚持使用界面生成器。

这里需要考虑的另一点是，开发人员长期以来一直认为，如果苹果希望 iPad 被视为“专业”设备，就应该有一个适用于 iPad 的 Xcode 版本。其中的一个问题是界面构建器——很难看出它是如何与触摸界面一起工作的。但是有了 SwiftUI 和 iPadOS，苹果有可能做出 iPad 版的 Xcode 吗？

## [](#should-you-use-swiftui)该不该用 SwiftUI？

我希望从我之前的段落中，你已经带着对为什么苹果制造 SwiftUI 以及为什么它对我们作为开发者有好处的良好感觉离开了。就我个人而言，我发现即使在这些早期测试阶段使用它也是一种乐趣，但一些反对使用 Swift 的论点现在可以再次应用于 SwiftUI。

SwiftUI 非常新，这一点毋庸置疑。这是非常新的，甚至在 WWDC 发布的少数测试版中，我们也看到了一些突破性的变化。感觉还是有很多问题，但是我是在一个测试版的 Xcode 操作系统上运行的，把所有的不稳定都归咎于 SwiftUI 是不公平的。

SwiftUI 还不能完全替代 UIKit/AppKit/WatchKit 等。许多界面元素都有 SwiftUI 等价物，我推荐 [Gosh Darn SwiftUI 站点](https://goshdarnswiftui.com)，它维护了一个 UIKit 等价物列表以及非常有用的 SwiftUI 代码片段。但是，即使 SwiftUI 没有您想要的 UI 元素，也有两个简单的选择:使用 UIKit/AppKit 或构建自己的 UI 元素。苹果已经确保 UIKIt/AppKit 代码与 SwiftUI 混合搭配没有问题。也许 SwiftUI 工具将允许您构建自己版本的缺失元素。我需要一个进度条，我自己用很少的代码做了一个，最终得到了我认为比标准的更好的外观。

[![Progress Bar](../Images/a3fa0340e26e7a227eb68fe04bd72d25.png)T2】](https://github.com/trozware/swiftui_progressbar)

*点击图片链接到 GitHub 知识库。*

多年来，苹果一直告诉我们在应用程序中使用标准界面元素，如果我们这样做了，当系统更新改变了外观和感觉时，我们基本上免费获得了这种改变。现在，他们给我们提供了更多的免费服务，有效地说，告诉我们你想要什么样的 UI 元素，我们会为平台和用户设置完成所有的配置工作。

但有了这个，苹果给了我们很多可以应用于元素的修改器以及一个很棒的动画套件，所以我希望在应用程序中看到更多有趣的设计选择，同时他们仍然坚持各种平台的所有标准人机界面指南。

苹果并没有宣传 SwiftUI 是“一次编写，随处运行”，而是“一次学习，随处应用”，这是一个重要的区别。乍看之下，我们似乎可以写一次，但只能写基础。你仍然需要为一个平台设计合适的 UI，但是它将能够重用同一应用程序的其他版本的组件。

我是否打算在下一个应用中使用 SwiftUI 是的。如果我是在为 NASA 写代码，我不会这么做，但是我的应用程序很少是任务关键型的，所以我可以放纵自己，边做边学。当有突破性的变化时，这将是令人沮丧的，但同时，我的错误报告将使它变得更好。

一个警告是，SwiftUI 应用将需要最新的操作系统，iOS 13 和 macOS 10.15，因此如果你的应用必须支持旧版本的系统，你必须等到明年。但是没有什么可以阻止您构建一些测试组件并开始学习过程。