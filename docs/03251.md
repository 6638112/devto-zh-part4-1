# 当蜂群不够时(一次不可思议的旅程)

> 原文:[https://dev . to/fluid _ thoughts 9/when-the-swarm-not-when-when-when-when-when-when-when-sow-a-discrete-journey-4068](https://dev.to/fluid_thoughts9/when-the-swarm-isn-t-enough-an-incredible-journey-4068)

# [](#exit-docker-swarm)退出码头工人群

大约两年半前，我被赋予了一项不可能完成的任务，就像疾速追杀一样。我的任务是找到一个整体系统，并尝试将它分成几个部分，然后将这些部分转换成微服务。这有几个问题。

1.  数据库中有如此多的异花授粉，你会认为种植超级杂草是不可避免的。换句话说，开发人员绕过服务 api 和 DAO 层，直接与数据库交互。
2.  使用 Java 1.2 标准编写，还需要我多说吗
3.  单元/功能/集成测试是狗屎
4.  还有更多，但我不想列出来。

所以我们决定从头开始重写整个应用程序，我们使用 OpenApi 规范来定义我们的 Api 调用，我们为每个微服务使用 Java Spring 架构。我们甚至创建了一些使用 express 和其他 npm 包的 JS 微服务。

当时，我们被告知微服务需要作为 VM 部署在 openstack 中(我承认这种方法并不有趣)。然后我们有了第一个客户，我们有两周的时间将我们的应用程序部署到客户的 VMware 环境中。这意味着没有 openstack，是的，哦，妈的！那我们做了什么？

我当时正在试验使用 Docker Compose，我们使用容器 nestle tea plunge 并使用 Docker Compose 部署我们的应用程序。除了静态的可伸缩性之外，这实际上做得很好。

然后，我们采取了自然的下一步，启用 Docker Swarm 并扩展我们的服务。我们有管理节点和工作节点，应用程序运行得很好。我们发现 Docker Swarm 的一个主要问题是利用其入口网络。我们发现过时的 DNS 条目。此外，没有弹性水平缩放。所以我们开始寻找。进入 K8 的........

## [](#enter-kubernetes)输入 Kubernetes

我们和我们的团队谈过，每个人都同意搬到 Kubernetes。所以我和我的建筑团队聚在一起，寻求一家咨询公司的帮助。我们与一个由 4 人组成的优秀团队(共 6 人)一起工作了 10 周，学习如何在 AWS(云形成，地形)中将基础设施作为代码，以设置垂直扩展和水平扩展。我们甚至在 10 周内的 4 周内就能够使用 kubespray 进行裸机部署。

应用程序、CI/CD 和容器编排的重建都发生在过去的 2.5 年里。我学到了很多关于开发操作、应用程序线程和共享内存的知识。我们使用了如此多的第三方产品，令人难以置信。奇怪的是，我每天都觉得脑袋里满满的。

感谢您花时间阅读我的不可思议的旅程。