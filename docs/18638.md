# AWS DevOps Pro 认证博客文章系列:数据库

> 原文：<https://dev.to/booyaa/aws-devops-pro-certification-blog-post-series-databases-244f>

扬·安东宁·科拉尔在 Unsplash 上拍摄的照片

## 概不退换

使用 AWS 要花钱，其中一些服务可能不属于 AWS 免费层。你可以通过拆除你在学习时创造的任何东西来降低成本，但仍然有可能产生巨额账单，所以要注意你设置的实例！

我非常幸运能够使用我雇主的 AWS 帐户。你应该问问你工作的地方，是否可以做类似的安排作为你学习的一部分。

## 谁快窒息征服谁

当我试图完善我的每个领域的心智模型时，博客帖子的格式很容易改变，所以请确保定期重温博客帖子。

## 什么？

**亚马逊 RDS** 是关系数据库引擎服务(RDS)的托管服务。AWS 支持以下引擎:

*   MySQL 是一个开源数据库引擎
*   MariaDB 是 MySQL 的一个分支，当时前者被 Oracle 收购(通过对 Sun Systems 的收购)
*   PostgreSQL 是一个开源数据库引擎
*   Oracle 是由 Oracle 开发的商业引擎
*   SQL Server 是微软的商业引擎
*   Amazon Aurora 是一个 MySQL / Postgres 兼容的关系数据库引擎

亚马逊 DynamoDB 是亚马逊提供的专有 NoSQL 数据库服务。

## 为什么？

与所有托管服务一样，数据库引擎的托管服务消除了一些关键问题:

*   托管数据库引擎的服务器的供应/扩展/终止
*   服务器维护(打补丁)
*   备份和恢复

这些问题通常会影响提供容错、高可用性和灾难恢复应急能力的数据库服务器的能力。

注意:关于存储扩展有一个警告，它不适用于 SQL Server 实例。详细信息可以在 [SQL Server 常见问题解答中找到:为什么我不能扩展我的存储？](https://aws.amazon.com/rds/sqlserver/faqs/)。

为了理解 Amazon RDS 和 Amazon DynamoDB 之间的区别，我提供了以下示例:

关系数据库引擎(有时称为 RDBMS)本质上是表格形式的，您可以将它想象成一个电子表格，其中字段作为列标题，行作为数据的单个记录。术语“关系”来自于通过外键来链接表的能力，这种能力的一个例子可能是一列`developer`和他们最喜欢的`food`的列表。链接可能是`developers`表中一个名为`food_id`的列，它将引用`food`表中一个名为`id`的列。

`developer` (s)表

| 身份证明（identification） | 名字 | 食物 _id |
| --- | --- | --- |
| one | 爱丽丝 | one |
| Two | 鲍勃（人名） | one |
| three | 颂歌 | Two |

`food` (s)表

| 身份证明（identification） | 名字 |
| --- | --- |
| one | 香蕉 |
| Two | 坚果 |

如果您要从`food`表中删除 nuts (id: `2`)，您将触发一个错误警告，提示在`developer`表中存在依赖关系。

从这个例子中得到的关键是记住关系数据库以表格的形式存储记录。

NoSQL 数据库引擎有点包罗万象，但本质上，如果你不把你的数据存储在白板上，你可能是一个 NoSQL 数据库引擎。Amazon DynamoDB 是一个键/值对和文档存储。Key/Value store 允许你像 Hash(关联数组/字典)一样存储数据，你提供一个`key`并返回值，你可能不知道已经使用了一个，因为它们通常被称为缓存服务器，即 Redis。文档存储允许您以结构化的方式存储数据。常见的格式有 XML 和 JSON，通常这些是大多数人与 NoSQL 联系在一起的数据库引擎，即 CouchDB 和 MongoDB。

## 什么时候？

Amazon Aurora 提供了一个兼容的引擎，比 PostgreSQL 快 3 倍，比 MySQL 快 5 倍。就成本效益而言，您需要将其他 RDS 引擎作为多 AZ 部署和内存优化实例进行比较。

就该领域而言，它与其他 RDS 产品的不同之处在于:

*   Aurora 可以故障切换到 15 个读取副本中的 1 个，对主实例的影响很小。
    *   您可以使用 MySQL 副本而不是 Aurora 原生副本，但您只能使用 5 个副本，这对主实例有很大影响。
    *   副本升级到主副本的顺序可以自定义。
*   数据存储在 10GB 区块中，跨三个可用性区域复制了 6 份拷贝。
    *   奥罗拉将继续处理:
    *   丢失 2 份数据拷贝时的写入能力
    *   丢失 3 份数据拷贝时的读取能力
*   对数据块和磁盘进行错误扫描并自动修复

通过保留生产 Oracle 或 SQL Server 数据库服务器的副本，Amazon RDS 可以成为您的灾难恢复策略的一部分。

Amazon DynamoDB 需要更多的考虑来利用它与这个领域相关的特性。为分区键选择错误的方案会导致数据库 I/O 不足。

需要考虑的事项:

*   您需要为使用的 I/O 数量(而不是实例大小)付费。单位大小以千字节为单位，并根据 I/O 操作的类型而有所不同:
    *   读取容量单位(RCU)以 4KB 数据块为单位，因此 8KB 数据块将消耗 2 个 rcu
    *   写容量单位(WCU)以 1KB 数据块为单位，因此 5KB 数据块将消耗 5 个 wcu
    *   表中的数据存储为 10GB 的分区，可以处理 3K RCU 和 1K WCU
    *   当您将该表扩展为更多 10GB 分区时，RCU 和 WCU 将跨分区分布，也就是说，如果您有 2 个分区，则跨这 2 个分区最多有 1.5K RCUs 和 0.5K WCUs。
*   术语
    *   表(发电机 DB 的最高级别单位)
    *   项目(记录)
    *   属性(记录的列或字段)
    *   主键可以包括
    *   只是一个分区键(通常称为主索引，用于查询表)
    *   分区键和排序键这就是所谓的复合主键
    *   辅助索引(允许您查询不同的属性)
    *   Local -需要相同的分区键，但是排序键可以不同
    *   全局-分区和排序键可以有不同的属性
*   针对大量写入用例的策略建议您添加一个从预定范围内随机生成的数字。例如，如果分区键是基于发票号(1234)的复合属性，那么您将满足随机生成的数字(1)的结尾，因此复合键将是:`1234` - `1`。

延伸阅读:

*   [AWS DynamoDB 备忘单](http://serverlessarchitecture.com/2016/03/22/aws-dynamodb-cheat-sheet/)
*   [AWS DynamoDB 分区和密钥设计](https://read.korzh.cloud/aws-dynamodb-partitions-and-key-design-56688bee8502)
*   [AWS DynamoDB:选择正确的分区键](https://aws.amazon.com/blogs/database/choosing-the-right-dynamodb-partition-key/)
*   [dynamo db 的关键概念](https://www.dynamodbguide.com/key-concepts/)

## 如何？

Amazon Aurora 要求您选择引擎兼容性，即 MySQL 或 PostgreSQL，然后定义:

*   创建数据库集群参数组(应用于数据库集群中所有实例的参数)
*   创建数据库集群(与数据库集群相关联的一组实例)
*   创建数据库实例(向数据库集群添加新实例)

AWS CLI 提供了一个 cli [演练](https://docs.aws.amazon.com/cli/latest/userguide/cli-services-dynamodb.html),演示如何供应表、存储项目和执行查询。应该注意的是，根据经验，您可能会使用[AWS SDK][aws_sdk]来存储和检索 DynamoDB 中的数据。

## API 和 CLI 特性和动词

### 亚马逊 RDS

#### 特性

*   数据库(集群)参数组
*   数据库集群
*   数据库实例
*   数据库(集群)快照

#### 动词(CRUD)

*   创建/复制
*   形容
*   修改
*   删除

#### 离群值

不是我最好的工作将看到我是否可以优化这个列表。

*   将选项添加到选项组
*   将角色添加到数据库集群
*   将角色添加到数据库实例
*   向订阅添加源标识符
*   将标签添加到资源
*   应用-待定-维护-操作
*   authorize-db-security-group-ingress
*   回溯数据库聚类
*   复制选项组
*   创建-数据库-集群-端点
*   创建数据库实例读取副本
*   create-db-security-group
*   创建数据库子网组
*   创建-事件-订阅
*   创建全局集群
*   创建选项组
*   删除-db-cluster-endpoint
*   删除数据库实例自动备份
*   删除数据库参数组
*   delete-db-security-group
*   删除数据库快照
*   删除-数据库-子网-组
*   删除-事件-订阅
*   删除-全局-集群
*   删除选项组
*   描述-帐户-属性
*   描述-证书
*   描述-数据库-聚类-回溯
*   描述-数据库-集群-端点
*   描述-数据库-集群-参数
*   描述-数据库-集群-快照-属性
*   描述-数据库-引擎-版本
*   描述-数据库-实例-自动备份
*   描述数据库日志文件
*   描述数据库参数组
*   描述-数据库-参数
*   描述-数据库-安全-组
*   描述-数据库-快照-属性
*   描述-数据库-子网-组
*   描述-引擎-默认-集群-参数
*   描述-发动机-默认-参数
*   描述-事件-类别
*   描述-事件-订阅
*   描述-事件
*   描述-全局-集群
*   描述-选项-组-选项
*   描述-选项-组
*   描述-可订购-数据库-实例-选项
*   描述-待定-维护-操作
*   描述-保留-数据库-实例
*   描述-保留-数据库-实例-产品
*   描述-源-区域
*   描述-有效-数据库-实例-修改
*   下载-数据库-日志文件-部分
*   故障转移-数据库-集群
*   生成-db-auth-token
*   资源的列表标记
*   修改当前数据库集群容量
*   修改-db-cluster-endpoint
*   修改-db-cluster-snapshot-attribute
*   修改数据库快照属性
*   修改-db-subnet-group
*   修改-事件-订阅
*   修改-全局-集群
*   升级-读取-复制
*   升级-读取-复制-数据库-集群
*   购买-预订-数据库-实例-产品
*   重新启动数据库实例
*   从全局集群中删除
*   从选项组中删除选项
*   从数据库集群中删除角色
*   从数据库实例中删除角色
*   从订阅中删除源标识符
*   从资源中移除标记
*   重置数据库集群参数组
*   重置数据库参数组
*   restore-db-cluster-from-s3
*   从快照恢复数据库集群
*   将数据库集群还原到时间点
*   从数据库快照还原数据库实例
*   restore-db-instance-from-s3
*   将数据库实例还原到时间点
*   revoke-d b-security-group-ingress
*   开始-活动-流
*   启动数据库集群
*   启动数据库实例
*   停止活动流
*   停止数据库集群
*   停止数据库实例
*   等待

### 亚马逊 DynamoDB

#### 特性

*   项目
*   支持
*   (全局)表

#### 动词(CRUD)

*   创建(全局表、表和备份)
*   描述/列表(全局表、表和备份)、获取项目、批量获取项目
*   更新(全局表、表和备份)、放置项目、批量放置项目
*   删除

#### 离群值

*   描述-连续-备份
*   描述-端点
*   描述-全局-表格-设置
*   描述-限制
*   描述生存时间
*   资源列表标签
*   询问
*   从备份中还原表
*   将表还原到时间点
*   扫描
*   标签资源
*   事务处理-获取-项目
*   事务处理-写入-项目
*   UNTAG-资源
*   更新-连续-备份
*   更新-全局-表格-设置
*   更新-生存时间
*   等待

Unsplash 路径(我使用什么术语来获得封面图像):数据库

*要进入系列的下一部分，点击当前标记(黑点)旁边的灰点。*