# AWS Amplify 中的所有无服务器功能-第 1 部分

> 原文：<https://dev.to/theworstdev/everything-serverless-functions-in-aws-amplify-part-1-26e3>

[https://www.youtube.com/embed/d0Dqsfql6os](https://www.youtube.com/embed/d0Dqsfql6os)

在这个系列的介绍中，我用 create-react-app 建立了一个新的 React 项目，配置 AWS Amplify。然后我创建一个无服务器函数，并通过 GraphQL 和 AWS AppSync 访问它。

## 链接自视频:

*   [Nader 关于配置 Amplify CLI 的视频](https://www.youtube.com/watch?v=fWbM5DLh25U)
*   [放大入门文档](https://aws-amplify.github.io/docs/js/react)

## 抄录:

**Kurt Kemple 0:01**
大家好，感谢大家收看 AWS amplify 的第一集《万物服务功能》。今天我们来看看如何设置一个基本的服务器列表函数，这个函数表示 hello world，并把它放在带有 epic 的 graph kill API 之后。而我们不会在不离开 VS 代码的情况下做这一切。要做到这一点，我只需光盘到我的项目目录，并运行和 PEX 创建反应。我们就称它为你好，世界。好，这将创建项目，安装依赖项，我将快进，完成后再见。好了，这个项目已经完成了，我已经用 VS 代码打开了这个项目，我要把终端重新打开。现在我们有了我们的项目，我们的基本 react 应用程序，我们要做的第一件事是将它编织成一个放大项目。

**科特肯普尔 1:24**
T3】为名字会选择你好世界。为了环境，我选 Dev。我将为项目 react 选择 Visual Studio 代码编辑器、JavaScript。它知道这是一个创建反应堆的项目。所以它会继续给我那些智能默认值。最后，我必须使用侧写。因此，如果这是您第一次使用 amplify，您可能会收到配置 amplify CLI 的请求。

Kurt Kemple 2:00

我会上传一段 Nader Dabit 的 YouTube 视频，你们可以去看看，这里还有链接。这将引导您完成配置。如果你看放大的文档，它也在文档的最开始。但是，是的，现在我要快进了，当它运行的时候，我会看到你。好了，现在已经完成了，让我们继续添加一个 API。

对于类型，将选择图形 QL，对于 API 名称，将坚持使用 hello world 将选择 API 密钥，我们不需要身份验证来使用应用程序，我们没有带注释的模式，因此我们将继续创建一个。所以我们会选择是。这里我要做单个物体。是的，我们现在想编辑它。所以它打开了模式。我要做的是，我要摆脱这个待办事项模型。如果你不熟悉，这些指令，或图形 QL，转换，基本上是什么让你定制和创建应用同步图形 API 的，但通过这种模式，然后得到部署，它知道你试图建立什么。所以我们实际上要把它去掉，因为我们现在只想通过一个盈余函数来处理我们的 hello world。

所以我们实际上要说的是查询的类型。你好世界是我们的查询，对吗？现在它不需要任何参数，它将返回一个字符串，这是必须的。然后在这里，我们会说函数，因为它会被一个函数支持。我们还没有创造出来。但是我们接下来会。因此，对于名称，我们将说你好世界，这是很多你好世界的东西，对不对？但问题是。因为我们是用 amplify 创建的，amplify 支持多种环境，也就是说，如果我创建了，我们就创建了 Dev，但是如果我想要像生产或暂存这样的东西，我们就不一定要使用相同的服务功能。因此，我们可以在这里使用这种变量，比如说，一个用于开发，一个用于生产，一个用于我们碰巧创建的每个环境。原来如此。这是我们的模式，我们只使用这一个指令，你知道，这里没有什么其他真正疯狂的事情发生。是的，我们保存它，然后按“继续”。

Kurt Kemple 4:45

好了，我们在这里错过的，本质上，是模式被创建了。因此，接下来的一些步骤将是推动它，或者我们实际上要看看嘲讽，但首先，我们必须添加我们的功能。

**科特肯普尔 5:03**
所以我们运行 amplify add 函数。

Kurt Kemple 5:12

所以对于名称，我们说，在我们的模式中，它将是 hello world，所以让我们确保我们称它为 hello world。在这里，我们称之为 hello world。这将是一个简单的 Hello World 函数。所以我们有其他的选择，对吧。因此，如果我们有存储设置，我们还可以执行信用函数，并访问我们在此 amplify 项目中创建的 Dynamo DB 表。或者，如果我们只是想，我们将知道我们可能要构建几个不同的路由，或者类似的东西，我们实际上可以在 REST API 上完全重新创建 REST API，但它将是服务，由 API 网关支持，并使用 Express。所以，你只需要写 API 文档获取路径，然后处理这些请求，就像你在一个快车上一样。目前，我们不需要这些。

因此，我们将继续使用 Hello World 函数。从技术上讲，不，我们不想访问其他资源，图 QL 将访问它。但是，我们不需要从函数或用户或任何类似的方面来喜欢访问图 QL。所以我们现在可以点击“知道”。在本系列的稍后部分，我们将更深入地了解这些选项，因为您可以做一些非常强大的事情。好的，让我们现在编辑一下，这样我们就能看到它的样子了。

你看这里，我们得到了 lambda 函数。它将输出 hello world。完美。这本质上正是我们想要的。这里的控制台注销是关键。比如，你看这里，我们有这个事件，JSON，它有键。因此，如果这个 lambda 函数要接收这样的事件，而不是通过图形 QL 使用，您可以像这样接收离开它。这就意味着那些数据在那里，我们不需要这些。所以我们要处理掉它。仅此而已。这是我们的服务功能，所以我们可以点击继续。好了，都完成了。现在我们已经设置好了，让我们运行 amplify mock，这样我们就可以测试它了。因此，在这个过程中，我将继续快进，以便我们能够继续前进。

**Kurt Kemple 7:27**
T3】这样一个图 QL 代码就为我们生成完成了，如果我们想像这样将生成所有的查询订阅，而在我们突变的情况下，我们只有一个单一的查询。所以不会产生太多。但是你可以得到它，你知道，只是普通的 JS，你可以用 TypeScript 定义得到。如果你更喜欢类型，那么为了简单起见，你可以坚持使用 JavaScript。所以对于文件来说，是的，当然，它会把它放在一个叫克拉夫特·QL 的文件夹里，在我们剩下的代码所在的目录里。你知道，我们想产生所有的突变订阅。因此，在这里，您可以指定并分解您想要生成的内容，但我们可以说是，然后这是深度，如果您使用过 QL 图表，可能很久以前就知道访问多个图层的成本会很高，比如说您有带评论的博客帖子，您知道，然后从评论中，您可以找到他们的作者，您可以获得他们的博客帖子并获得这些评论，等等。所以你可以变得非常昂贵。所以这就限制了深度。所以在这种情况下，你只能往下走两层。

好了，我们的 graphQL 端点已经成功设置，我们被嘲笑了。因此，理论上，在这一点上，我们可以开始查询，但我们需要用 API 键来做这件事，因为我们说过要这样做，所以首先，我们要设置我们的客户端。然后，我们将继续更新 React 应用程序以调用目录和或函数，我们将查看结果。首先，我们要添加依赖项，这是 AWS amplify，它包含不同类别的所有类中的主要 amplify like 对象。

比如 API、分析、预测等等。然后我们还将添加 AWS amplify react。实际上，我们还不需要这个，因为我们还没有做任何像这样有一堆预制组件的产品。因此，如果我们要添加，我喜欢使用预构建的身份验证器，它可以为您提供完整的登录流程。完全完成了。你什么都不用做，但是我们只是在做 API key，所以不会需要。所以我们要加上 amplify。在安装的同时，我们将开放源代码。我想指出两件事。一个是这个 AWS 导出文件。这实际上是存储基本配置的地方。是的，我们需要做的是配置 amplify，我们这样做的方法是，从 AWS amplify 导入 amplify，然后导入配置，它将称为 Apple fi，config。

这将来自 AWS 导出文件。然后我们将配置它来放大配置。这就是实际配置它所需要的一切。现在，我们想正确地使用它，我们想调用这个函数。今天，我们实际上要进入应用程序 JS。我们要做一些事情。我们将陈述和使用效果。

Kurt Kemple 11:14

我们还将从 AWS amplify 导入 API 和图形 QL 操作。因此，我们在这里要做的是，我们将创建状态来存储我们的消息，并在默认情况下将其设置为“否”。然后我们将使用一个效果来获取该消息。

**科特肯普尔 11:57**
T3】所以现在这就定下了我们的消息。所以我们来这里吧。我们会说，如果有消息，显示消息，否则，默认已经存在。所以现在我们已经设置好了。所以我们要继续了。实际上，我需要打开浏览器。我将在 VS 代码中完成。但是我还没有安装那个扩展。我们将在这里暂停，我将安装它。然后我们将打开这个项目并运行它。

如果一切正常，我们将有一个无服务器的功能。好的，我已经安装了浏览器预览版。我已经准备好打开项目了。但是我意识到我们已经使用了我们的查询 hello world，但是我们实际上还没有定义它。因此，我想借此机会查看文件夹，我们看到我们有源图 QL 查询，我们打开它，我们得到 hello world。这是自动为我们生成的，我们不需要这样做。因此，让我们继续导入它。

**科特肯普尔 14:14**
T3】好了，现在我们准备运行项目。好了，我们有自己的身材了。所以，让我们做公开预览，我们得到你好世界。所以我们的函数被调用。我们现在能够通过图形 API 访问该功能。所以，我们再次使用了 API SDK，在自动生成的随机 craft kill 操作中，我们设置了一个服务器列表函数。既然我们在嘲笑这个，我们实际上可以实时做出改变。所以让我们继续改变这一点。让我们向宇宙问好。没错。所以我们改变了重载页面，你好宇宙。因此，现在我们可以进行局部更改，让功能按照我们想要的方式工作，就像我们已经完全准备好了一样，然后将它部署到 AWS。所以这只是一个大大改进的工作流程。让我们来看看。

**Kurt Kemple 15:34**

要做到这一点，我们需要做的下一件事是运行 amplify，push，这将把资源放入 AWS。然后，如果我们重新启动应用程序，我们实际上会与生产服务进行对话。相反，我还不打算推出它，因为即使我们正在做这个视频，我们还没有完成建立这个这个函数或这个图形 kill API。因此，在下一个视频中，我们将看看如何给这个 lambda 函数添加依赖项，比如使用其他 MPM 包，以及我们如何处理参数。也许我们会添加一些有趣的东西并获取一些实际的数据。好的，谢谢你加入我。我希望你喜欢这个，下周见。再见了。