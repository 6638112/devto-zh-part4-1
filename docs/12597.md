# 网站越来越多

> 原文:[https://dev.to/joshransley/websites-are-getting-fat-7nd](https://dev.to/joshransley/websites-are-getting-fat-7nd)

*这是前阵子在[我自己的博客](https://joshransley.com/blog)上发布的。在潜伏了一段时间后，我最近加入了 dev.to，并认为我可以做出一些贡献。*

* * *

我最近访问了一个“重”22MB 的网站。22 兆字节，压缩的。

太荒谬了。

近几年来，平均页面权重有所增加，这里的权重是指组成一个网站的所有图片和代码的总大小。如果这些对你来说没有任何意义，那么我只想说 22MB 对于一个网站来说是荒谬的。我们旅游博客的页面上，充满了我们探险的图片，页面仍然在 10MB 左右(我承认这比它们实际应该的要大)。

但是访问一些网站，无论是新闻网站、博客、电子商务网站还是其他类型的网站，你可能会发现大多数网站都比它们应该有的要大得多——5MB 到 10MB 的页面并不少见。

体重增加会带来问题。当设计师、开发人员或企业主在高速宽带的台式机或更高性能的笔记本电脑上浏览网站时，他们通常不会注意到这一点。事实上，我决定选择的网站在我办公室的高速光纤连接上加载速度相当快。

但是你说你的大多数用户都在西方国家，他们确实有快速连接，所以这不会影响我，而且我的网站也没有那么大。但是当你的用户没有超高速宽带连接时，问题就来了。当他们在火车上，快速穿过不完整的 4G 网络，或者更糟的是，3G 网络——上帝禁止边缘。当你的用户在泰国，试图用他们的旅行 SIM 卡加载你的网站时，问题就来了，因为这些 SIM 卡的数据非常有限。或者甚至对于计量连接的大多数美国用户来说。或者你的应用程序或网站是为长期网速慢的用户设计的。

那些 22MB 的网站加起来。

绝大多数时候，网站没有必要那么大。它只是偶然发生的。这在很大程度上是 WordPress、Wix 和其他网站建设者的结果。当通过 CMS 或网站构建器编辑内容的人没有意识到他们不应该直接从 50MP 相机上传全分辨率照片时，就会发生这种情况。当然，如果一切顺利的话，网站将会根据需要对这些图片进行缩放和优化，这样图片就可以上传到任何大小，并以正确的大小发送给用户。然而，经常出现的情况是，糟糕的网站设置和知识的缺乏相结合，使得我们的网站在一个 hero slider 中加载了几个大约 4MB 的图片，而作为粗略的指南，它们实际上应该少于 4MB。

## [](#example-time)举例时间

最近，我重建并启动了一个新的鱼池网站，并于 12 月开始工作。他们的旧网站是用 WordPress 建立的，这本身并不是一件坏事。让我们先弄清楚这一点，我认为 WordPress 和其他工具一样，我认为我们可以很好地使用它并建立伟大的网站，我认为它可以被糟糕地使用并用来建立臃肿，缓慢的网站，就像其他工具一样。不幸的是，由于各种各样的原因，WordPress 网站经常处于较重的一边。

我们将跳过重新开发网站时遇到的各种其他要求和过程，只关注页面权重和性能。

### [](#room-for-improvement)提升空间

现有的 Fishpie 网站远非臃肿页面的罪魁祸首，但仍有一些改进的空间。注意到一些页面的权重，粗略的平均值似乎是 3MB，略高于网络的表面平均值，但实际上，我认为它可能远低于当前的中位数，从整体来看，这种性质的网站是可以接受的。

但我认为还有改进的空间。因此，考虑到 3MB 的数字，我决定我的改进措施是将它减半，并将其作为我的最大值，而不仅仅是平均值。我的目标是建立一个每页最大 1.5 兆字节的新网站。如今，对于一个网页来说，这是一个相当小的数字，因为要加载图像和其他资源。

虽然 Fishpie 网站的流量不高，但这种页面权重的降低会减少每个人的加载时间，而不仅仅是那些网速慢的人。它还会减少服务器的负载，对于这种规模的网站来说，实际的影响可以忽略不计，但这仍然是积极的。

### [](#how-do)怎么做？

我如何计划将页面重量减半？嗯，有了这个项目，我可以自由地完全重建网站，使用我选择的任何有帮助的包/框架/平台。

我选择用 Statamic(一个相对不太出名的 CMS)来建立这个新网站，虽然这个 CMS 已经被证明是一个伟大的工具，但它并不是唯一一个能够产生轻量级网站的工具。

我认为我能够构建低于 1.5MB 的页面的主要原因是因为我知道我从一个 0MB 的页面开始，并且只添加我需要的东西。而不是从 WordPress 模板的 2MB+页面开始，在我添加任何内容之前。这意味着每个额外的资产都经过仔细考虑，而不是默认包含在内。

### [](#compress-yo-images)压缩哟’图片！

另一个减轻页面重量的快速方法是重新调整图片的大小和压缩图片。这通常是导致大量页面的首要原因。

Statamic 提供了在提供图像时调整图像大小和压缩图像的功能，然后在后续请求中提供缓存版本。它不是唯一提供这种功能的平台，但肯定是我合作过的最聪明的平台。这意味着你或你的用户可以上传他们喜欢的任何尺寸的图片(在你的服务器设置的范围内)，它会根据需要调整大小和压缩图片。

如果你正在使用一个不提供该功能的现有网站，或者你正在建立一个静态网站，那么达到同样目的的最好方法是手动调整图片大小并压缩它们。图像编辑软件，如 Photoshop 及其替代品对于调整图像大小非常有用，并且对减小文件大小大有帮助。你可以用一个工具做得更好，比如仅在 Mac 上使用的 ImageOptim T1，这是我的首选工具，但是只要搜索 T2 图像优化 T3，你就会找到适合你的东西。

<figure>

[![](../Images/776c195d6464b1d278a81aaf2d999834.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--lnF5SW9F--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://joshransley.com/blog/content/images/2019/04/compression-example.jpg)

<figcaption>ImageOptim offers some pretty good savings</figcaption>

</figure>

<figure>

[![](../Images/cddbc66cd84c1c70740913b64b0bcd35.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--KrwV6Qwm--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://joshransley.com/blog/content/images/2019/04/compression-example-compression.png)

<figcaption>Getting a bit meta here but this is the image above run through ImageOptim</figcaption>

</figure>

### [](#stop-asking-for-so-much)别要求那么多

减少页面重量的另一个简单方法是简单地从服务器请求更少的资源。打开你最喜欢的浏览器的网络标签，看看你的网站在请求什么。

<figure>

[![](../Images/0d71f3c3613b9f3919add5f0247e7def.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--TAIMVQBo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://joshransley.com/blog/content/images/2019/04/too-many-requests.png)

<figcaption>326 requests? Bloody hell. 100 would be quite a lot.</figcaption>

</figure>

你真的需要 5 种以上的网页字体，每种字体有四种不同的粗细吗？你还需要 jQuery 吗(我仍然在很多项目中使用它，但由于各种原因，我正在试图远离它)？你是否加载了用户看不到的图片？你知道这两个 JavaScript 文件是做什么的吗，也许它们属于一个旧的滑块或图库插件？

仔细检查每项资产，询问是否需要。运行一个开发站点(如果你还没有运行的话，你真的应该这样做),根据需要分组或单独删除文件，每次都要测试站点。

可以说，随着时间的推移，在一个页面上加载这么多文件的负面影响已经减少了，但是减少不必要的请求仍然是一个好处。

### [](#gwhat)Gwhat？

GZIP。这就像是网络上的`.zip`文件。这是你的主机提供商(或者 VPS，如果你有的话)应该默认提供的功能，或者作为一个选项，你应该明确地启用它。除了启用它，这是一个零努力的方式，立即节省一些宝贵的 KB 的。你只会看到文本文件的好处——比如 CSS、JS 和实际的 HTML，但这仍然是值得做的。

## [](#step-by-step)循序渐进

1.  压缩你的图像。这通常是最大、最容易的储蓄。
2.  减少对旧 JS 和 CSS 之类东西的不必要请求。
3.  启用 GZIP。

你还可以做很多其他的事情，但是这些应该会让你走得很远。

额外提示:如果你在一个地方专门为用户服务，那么选择一个位于或靠近他们的服务器会让你的网站感觉更快。或者进行下一步，建立一个 [CDN](https://www.cloudflare.com/learning/cdn/what-is-a-cdn/) ，减少服务器的负载，为每个人提供服务，就像你是他们的本地人一样。