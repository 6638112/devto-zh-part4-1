# 使用条件包含将 git 配置模块化

> 原文：<https://dev.to/hartmann/modularizing-your-git-config-with-conditional-includes-2mlm>

你是跨机器跟踪你的 git 配置还是保持它与你的点文件同步？它是否充满了您想要在所有不同上下文之间共享的设置？根据具体情况，你想改变某些事情吗？好吧，我有消息告诉你！

## TL；博士:

如果您想为特定路径下的所有子目录使用额外的配置文件，请使用 git 2.13.0 中引入的`includeIf`功能。

```
[includeIf "gitdir:/"]
  path = path/to/your/.config 
```

这就是你所需要做的，但是如果你想知道更多关于它是如何工作的，以及一些你可能需要注意的警告，请继续阅读。

## `include`和`includeIf`

首先，如果我没有向您介绍这个特性的官方文档，那将是我的失职，您可以在这里找到这个文档。然而，那里有比你可能需要(和想要)的更多的信息，所以让我们提取重要的部分。

除了`includeIf`有一个必须满足的条件外，`include`和`includeIf`部分的工作方式相同。他们让你从另一个文件中插入配置到你的主文件中。

在我的情况下，这意味着每当 git 目录是`~/projects/work`的子目录时，我就可以自动更改我的电子邮件，允许我以一种简单而有效的方式始终使用我的工作电子邮件进行工作，而无需更改我的全局 git 配置或从我的主 dotfiles repo 分支。

以下是我的配置中的相关摘录:

```
[includeIf "gitdir:~/projects/work/"]
  path = ~/projects/work/.gitconfig 
```

我在`~/projects/work`目录中保存了一个单独的配置文件，它会覆盖我的电子邮件。

如果您的团队有关于空白、合并策略、注释字符等的特定规则，这也会很有用。你想强制执行的。

## 可能会绊倒你的事情

Syntax

注意`includeIf`行中目录路径后面的尾随斜杠。这使得它将匹配指定目录的所有子目录。正如文件所解释的:

> 如果图案以`/`结尾，则会自动添加 `**`。例如，图案`foo/`变成了`foo/**` 。换句话说，它递归地匹配“foo”和里面的所有内容。

这也意味着**如果没有尾随斜杠，它将只匹配特定的目录**。

File insertion

这是文档中的另一段引文:

> 被包含文件的内容被立即插入**，就好像它们是在 include 指令**的位置被发现的一样。如果变量值是相对路径，则该路径被认为是相对于包含指令的配置文件。

因此，您可能希望将 includes 放在文件的底部，以确保包含的配置不会在源文件中被覆盖。

* * *

我希望这为您澄清了一些事情，并且您发现它是有用的；我知道我做到了。如果你想要更深入的信息，请看文档。