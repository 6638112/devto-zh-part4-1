# 什么是无服务器架构，有什么优势？

> 原文:[https://dev . to/mkdev/what-is-server less-architecture-and-what-is-its-advantages-4d of](https://dev.to/mkdev/what-is-serverless-architecture-and-what-are-its-advantages-4d0f)

无论您是行业资深人士还是仅对现代架构感兴趣，您都可能听说过一种在云环境中运行应用程序的新方法，称为“无服务器”。在本文中，我们将讨论它到底是什么，是否真的值得，以及为什么传统服务器突然失宠。

### [](#definition)定义

这里有一个来自维基百科的[无服务器定义。](https://en.wikipedia.org/wiki/Serverless_computing)

> 无服务器计算是一种云计算执行模型，其中云提供商充当服务器，动态管理机器资源的分配。定价基于应用程序消耗的实际资源量，而不是预先购买的容量单位。

一开始可能不是很清楚，但是不要担心，你很快就会明白的。但在此之前，让我们先来看看维基百科的另一个定义。这一个是关于 FaaS，与无服务器密切相关的东西。

> 功能即服务(Function as a service，FaaS)是云计算服务的一个类别，它提供了一个平台，允许客户开发、运行和管理应用程序功能，而无需构建和维护通常与开发和启动应用程序相关的基础架构。

这些定义结合了任何可以被称为无服务器的东西的三个特征:

1.  抽象。您不管理运行程序的服务器。你对此一无所知。操作系统、更新和网络设置的所有细节都被隐藏，以便您可以专注于开发，而不是管理。

2.  弹性。无服务器提供程序会根据应用程序的负载情况自动为您提供或多或少的计算资源。

3.  成本效率。价格取决于你的应用是否被使用。如果没有，你不用支付任何费用，因为你不使用任何计算资源。你只需为你的应用被使用的时间付费。

4.  有限的生命周期。您的应用程序在容器中运行，一段时间后(从几分钟到几个小时)，服务会自动停止它。如果您的应用程序需要再次调用，那么，当然，新的容器将被启动。

### [](#application-area)应用领域

无服务器模式可以在任何地方使用，当然也有例外。然而，有一些情况对于第一次尝试来说是最容易和最安全的，因此我们建议你从它们开始。

例如，这种情况可能是后台任务，如:

*   上传到网站后创建图像的附加副本；
*   备份的计划创建；
*   向用户发送异步通知(推送、电子邮件、短信)；
*   不同的导出和导入任务。

所有这些任务要么是预定的，要么不意味着用户将得到即时响应。这是因为无服务器中的应用程序(功能)不是持续工作的，而是在需要时启动，然后自动禁用。因此，每次发射需要一些时间，有时长达几秒钟。

然而，这并不意味着你不能在应用程序中与用户交互的部分或者当响应时间很重要的时候使用无服务器。完全相反！无服务器功能广泛用于:

*   聊天机器人；
*   物联网应用的后端；
*   管理对您的主后端的请求(例如，使用用户代理、IP 和其他数据来识别用户，或者使用 IP 来接收用户的位置信息)；
*   完全独立的 API 端点。但是，这些事情对开发人员对模型的理解要求更高，所以如果我是你，我会从后台任务开始。

### [](#service-providers)服务商

如今，与 FaaS 相关的市场领导者之一是 AWS 及其 AWS Lambda。它支持许多编程语言(包括 Ruby、Python、Go、NodeJS、C#和 Java)和大量服务，这些服务不仅允许您使用无服务器计算，还允许您使用[数据库即服务](https://aws.amazon.com/dynamodb/)、[消息队列](https://aws.amazon.com/sqs/)、 [API 网关](https://aws.amazon.com/api-gateway/)和其他使您更容易使用该模型的东西。

谷歌云和微软 Azure 及其[谷歌功能](https://cloud.google.com/functions/docs/)和 [Azure 功能](https://azure.microsoft.com/en-us/services/functions/)也值得一提。我没有太多使用它们的经验，但是，据我所知，它们没有 AWS 好，还有很多需要改进的地方。例如，到目前为止，Google 只支持 NodeJS 和 Python。Azure 支持更多的语言，但是大部分目前只有实验性的支持。

此外，您不仅可以使用公共云提供商的服务来实现无服务器，还可以在自己的数据中心中实现。如果你对它感兴趣并想了解更多，你可以看看 [KNative](https://cloud.google.com/knative/) ，它允许你在 Kubernetes 或[open whish](https://openwhisk.apache.org/)上构建和运行无服务器应用。Openwhisk 是第一个让社区意识到在他们自己的服务器上没有服务器的可能性的产品。

### [](#advantages-in-a-nutshell)概括地说优点

在结束之前，让我们再看一下无服务器架构实现的所有优势。

1.  弹性。从零到数千个并行工作函数。

2.  从操作系统或任何其他应用程序相关软件中完全抽象出来。无论您的无服务器应用在哪里启动，无论是 Linux、Windows 还是定制操作系统。对你来说唯一重要的是平台执行 Python/Java/Ruby/YouNameIt 代码及其库的能力。

3.  通过适当的函数设计，可以更容易地构建一个松散耦合的架构，其中单个函数中的错误不会影响整个应用程序的工作。

4.  新手入门门槛相对较低。对于一个团队中的新开发人员来说，掌握 100-500 行的“纳米”服务要比老项目的数百万行和大量遗留代码更容易。

### [](#what-about-disadvantages)缺点呢？

不幸的是(或者幸运的是)，我们的世界不仅仅是非黑即白，所有的技术和方法也不一定是好的或坏的。这意味着无服务器方式也有它的缺点，你可能会面临一些困难。它们中的大多数与任何其他分布式系统相同。

1.  因为任何其他功能或服务都可能对您的接口或业务逻辑敏感，所以您需要始终保持向后兼容性。

2.  经典的单片应用程序的集成方案与分布式系统的集成方案有很大不同。您需要记住异步交互和可能的延迟，并监控应用程序的不同部分。

3.  即使这些功能是隔离的，错误的架构也可能导致级联故障(当一个部分的故障可能引发其他部分的故障)。

4.  拥有强大的可伸缩性的代价是，如果函数没有被调用，它就不会运行。因此，当您需要实际运行它时，可能需要几秒钟，这对您的业务至关重要。

5.  如果有问题，当来自客户端的请求通过十几个函数时，很难确定错误的可能原因。

6.  所谓的供应商锁。专门为 AWS 开发的功能可能很难移植到，比如说，谷歌云。并不是因为一般的函数，JS 在任何地方都是一样的，而是因为无服务器函数很少被隔离。除此之外，您还将使用数据库、消息队列、日志记录系统和其他东西，这些东西总是因提供商而异。但是，如果你足够渴望，你可以让他们独立。

### [](#to-sum-up)总而言之

尽管我们发现缺点多于优点，但这并不意味着“功能即服务”是一种不好的方法，在阅读本文后，您需要永远忘记它。相反，大多数风险要么可以最小化，要么可以接受。例如，您可以预初始化这些功能，这样用户就不会等待它启动。也有一些调试的方法可以减少痛苦。供应商锁定对大多数企业来说也不是问题。

此外，无服务器方法并不意味着您需要立即将整个应用程序转移到这种模式。进化的方法，期望你从应用程序的非关键或面向客户的部分开始，在这里效果更好。

我真的认为未来属于无服务器模式吗(至少部分属于)？是的，确实如此。我真的认为这对所有公司都有好处吗？肯定不是。我真的认为每个人都应该花一点时间去尝试一下吗？是的，毫无疑问。

我确信这是一项以后可能会有用的技能。要自己尝试 AWS Serverless，你可以按照我在个人博客的文章[中列出的步骤，或者等待它在 mkdev 上发布。](http://zonov.me/amazon-lambda-api-gateway-introduction/)

感谢您阅读这篇文章。如果你对无服务器和微服务方法、Ruby 和 JS 以及云基础设施感兴趣，我将非常乐意成为你的导师。如果你有任何建设性的批评或建议，我洗耳恭听。

祝你工作和学习顺利，我亲爱的读者们！

### [](#supplementary-reading)补充阅读

1.  [我博客上的亚马逊 Lambda + API 网关介绍](http://zonov.me/amazon-lambda-api-gateway-introduction/)

2.  [构建一个 Amazon Lambda 函数来写入我博客上的 dynamo db](http://zonov.me/building-an-amazon-lambda-function-to-write-to-the-dynamodb/)

3.  [HOWTO:在我的博客上使用 Terraform 创建和集成 AWS Lambda 函数](http://zonov.me/howto-create-an-aws-lambda-function-using-terraform/)

4.  [Kirill Shirinkin 的虚拟化基础知识](https://mkdev.me/en/posts/virtualization-basics-and-an-introduction-to-kvm)

* * *

*这是[一篇由](https://mkdev.me/en/posts/what-is-serverless-architecture-and-what-are-its-advantages)[基里尔·佐诺夫](https://mkdev.me/en/mentors/graffzon)撰写的mkdev 文章。你可以请基里尔做你的私人导师。*