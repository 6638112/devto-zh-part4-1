# 单元测试模拟依赖调用

> 原文:[https://dev . to/LBA bich/unit-testing-mock-dependency-calls-443 p](https://dev.to/lbabich/unit-testing-mock-dependency-calls-443p)

所以我和一个同事正忙着检查单元测试动作。让我设置两个场景:

# [](#scenario-1)场景 1

*   有两种服务。*服务一*对*服务二*有依赖性。
*   *服务一*中的方法调用返回值，但也调用来自*服务二*的方法，同时向该方法传递值(*服务二*不返回值)。

# [](#scenario-2)场景二

*   有两种服务。*服务一*对*服务二*有依赖性。
*   *服务一*中的方法调用返回值，但也从*服务二*中调用方法，同时将值传递给该方法。
*   服务二方法有一个返回值，直接影响*服务一*的返回结果。

# [](#testing-scenarios)测试场景

对于**场景一**，我认为您应该首先存根*服务二*依赖。然后确保传递给存根的值是您所期望的。原因是您要确保外部依赖项传递了您所期望和调用的内容，因为您不应该直接知道它对它做了什么。

然而对于**场景 2** ，我的论点是你将存根*服务两个*依赖。但是，您不需要确保调用了该方法或者调用了什么方法。然而，如果它在某个逻辑分支之下，你要确保它被调用。然而，因为您直接确定了*服务二*方法的返回值，所以您是在测试特定于该单元测试的场景。如果你想知道什么被传递到那个方法和结果中，那么你要么需要重构你的代码，要么你需要做一个单元测试和集成测试场景。

我只是想听听人们对此的看法，以及他们是如何看待这件事的。