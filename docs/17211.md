# 观察-注意界限

> 原文:[https://dev . to/thaianhduc/observation-watch-out-boundaries-15e 5](https://dev.to/thaianhduc/observation-watch-out-boundaries-15e5)

*原文发布于[我的博客](https://www.thaianhduc.com/2019/06/observation-watch-out-boundaries/)2019 年 6 月 23 日*

当我刚开始我的软件开发生涯时，我认为写软件很难。这是真的。但是，当时对写软件的定义是不一样的。我真正的意思是我的代码满足了功能需求(并不总是如此)并且能够运行。那是我没有看到生产的时候。所以我的机器一切正常。

随着时间的推移，我有机会将我的代码投入生产，并看到它们运行。难怪他们在生产中表现不佳。每个开发者都知道著名的“它在我的机器上运行良好”。它在测试中可能工作得很好。但是它在生产上总是有问题。

为什么？这个问题没有单一的答案。软件是由具有不同水平技能、经验、智能，...即使这个团队拥有世界上最有才华的开发人员，他们的产品仍然有缺陷。因此，我并不试图找到解决这个问题的办法。相反，我接受并观察这个事实。没有万全之策，但有一些技巧和窍门可以尽可能地预防。

从我自己的经历，从 Pluralsight 课程，从 youtube，...从我接触的任何来源，我想记录我观察到的东西。我不打算详述每一个项目。相反，我想有一个清单和一些解释，参考。具体细节因项目而异。

## [](#sql)SQL

如果您使用 SQL Server 作为数据存储来构建应用程序，请注意两种常见的无限制模式

1.  选择 N+1
2.  Select *不带前 n 名

问谷歌“选择 N+1”你马上就知道是什么了。有详细的解释和代码示例。通常在 ORM 中工作过的开发人员非常了解它。

第二个注意有点棘手。这时，您的应用程序以这种模式向 SQL 发出查询

```
SELECT * FROM dbo.Employee WHERE [Predicate] 
```

在测试环境中，没有问题。然而，在生产中，数据是巨大的，并且该查询可能返回数百万条记录。

如今，许多应用程序不直接与数据库对话。取而代之的是介于两者之间的 ORM/LinqToSQL。而这段代码并不少见

```
var employeesByName = ctx.Employees.Where(x => x.Name.StartWith("Smith")).ToList(); 
```

一些 ORM 可能会对生成的查询进行限制。开发人员需要做的是检查所有生成的查询。

经验法则是始终控制返回记录的数量。把所有东西都开到最大。

## [](#connections)连接

应用程序建立的连接有很多种——连接到数据库，连接到外部服务。打这种电话时，有些人要小心

1.  超时:确保所有东西都设置了超时值。通常现代框架都有默认值。只要确保有，并且你知道它们。
2.  正确关闭连接。想象一下如果你的门被打开了会发生什么？坏事发生了。

## [](#json-serialization-and-deserialization)JSON -序列化和反序列化

JSON 很酷。开发人员每天都以这样或那样的形式使用 JSON。许多人认为这是理所当然的。我们很少关注数据的大小。我曾经在这里经历过这样一个问题[——一个架构的隐性成本](https://www.thaianhduc.com/2018/10/hidden-cost-of-an-architecture/)。
所以如果你必须在代码中直接使用 JSON，问这些问题

1.  我必须用它吗？还有其他选择吗？
2.  多大的？尺寸是否受到控制？

有些人可能会说 RAM 很便宜。那么我们为什么要过于在意大小呢？是的。RAM 很便宜，但也有局限性。一旦达到极限，您的应用程序将冻结或崩溃。如果您的应用程序运行在云上，那么您的应用程序所消耗的一切都会涉及成本。

## [](#enumerable-list-foreach)可枚举，列表，ForEach

开发人员是否在不使用循环的情况下编写代码？我们有没有想过一个列表中有多少项？当谈到列表时，我们应该意识到所有的条目都存储在内存中。所以大小在这里真的很重要，即使它是微不足道的。另一个陷阱是可枚举的。Enumerable 表示通常只迭代一次的序列。本质上，我们不知道序列的大小(IEnumerable 接口上没有 Count 属性)。所以，打电话的时候。注意所有可能发生的令人讨厌的事情。

我带过来做参考。这可能不会影响生产。但是意识到这一点也很好。

可能会有更多关于界限的东西需要注意。这些是我到目前为止想到的。你呢？