# 企业中的 Azure 功能

> 原文:[https://dev . to/marcroussy/azure-functions-in-the-enterprise-17 G5](https://dev.to/marcroussy/azure-functions-in-the-enterprise-17g5)

本文是 [#ServerlessSeptember](https://dev.to/azure/serverless-september-content-collection-2fhb) 的一部分。在这个无服务器的内容集合中，您可以找到其他有用的文章、详细的教程和视频。9 月份，每天都有来自社区成员和云倡导者的新文章发布，没错，每天都有。

* * *

。从我记事起，NET 就一直是构建企业和行业应用程序的首选平台。在过去，这些类型的应用程序在技术采用方面有落后的趋势。这种情况正在开始改变，很大程度上是因为托管云服务的好处，如 Azure SQL、Azure AD 以及今天的主题，无服务器，或者更准确地说是 [Azure Functions](https://marcroussy.com/2018/09/01/azure-functions-101/) 和 Logic Apps。

运营公司的日常活动需要业务线应用程序。这些应用可能只存在于企业内部，但这并不意味着它们不能利用云计算的力量。无服务器，尤其是函数，是扩展 LOB 应用程序的合理方式，而 LOB 应用程序正努力跟上当今的趋势。

下面我概述了 Azure 的无服务器堆栈让你尝试新的做事方式，简化你的日常工作，让新的编程任务变得更容易的几种方式。

# [](#experimenting-with-new-languages)试验新的语言

大多数软件开发团队都有特定的技术堆栈。大量的工作被投入到开发正确的实践、工具和基础设施来支持一个给定的技术栈，所以这不是你能在一毛钱上改变的事情。俗话说，当你只有一把锤子时，所有的问题看起来都像钉子。

但这恰恰是 Azure 函数可以混合使用的地方。大多数情况下，函数都很小，只执行一个动作来响应一个事件。它们可以用七种不同语言中的一种来写。有面向对象的语言(C#、Java)、动态类型的语言(JavaScript、Python)、函数式语言(F#)和脚本语言(PowerShell Core)。每种语言都有自己的特色。Python 更适合数据科学，F#使编写无错代码变得更容易，PowerShell 以其脚本能力而闻名，这只是举几个例子。

**函数让您有机会利用更多语言的优势**，而不必成为构建、部署、运行和监控其技术堆栈的专家。当然，你需要学习这门语言的基础，但这是有趣的部分。

当谈到持续集成和部署时，Azure DevOps 为您提供了针对其支持的语言的自定义任务和模板。运行函数的操作方面也不在您的控制之内，让您将全部精力放在代码上。

启用应用洞察后，调试生产问题变得轻而易举。它为您提供了您需要的反馈，帮助您找出代码中的问题，而不会影响性能。每一步都不需要猜测。

用函数构建一个小特性根本没有什么风险，因为您可以在几个小时内启动并运行。它们为你提供了一个安全的实验空间，所以下次你认为用其他方式可以更好地完成一项任务时，想想 Azure Functions。

# [](#making-logic-apps-friendlier)让逻辑应用更友好

逻辑应用是 Azure 中无服务器的第二个分支。功能和逻辑应用都是基于事件的，当 Azure 内发生事件时触发。但是触发逻辑应用的不仅仅是 Azure 服务。

他们可以连接到企业中经常使用的服务，如 Office365、Dynamics、SharePoint、SalesForce 等。出于这个原因，逻辑应用程序对于将根本不同的数据源联系在一起非常有用，否则你很难访问这些数据源。

逻辑应用程序是通过门户中的设计器或 Visual Studio 中的扩展创建的。首先，指定触发逻辑应用程序执行的事件；每当创建 SharePoint 文档时。然后，你告诉它如何处理相关的事件数据。也许是发送电子邮件，或者向数据库写入记录。您可以添加条件、循环和几乎任何您期望从基本编程语言中得到的东西。

添加的步骤越多，Logic App 就变得越大。设计师尽最大努力保持东西整洁，但是一个有很多步骤的逻辑应用程序很快就会变得笨拙。这就是让一个功能与逻辑应用程序一起工作有助于控制事情的地方。

作为开发人员，编写代码比设计工作流更舒服是很自然的，即使是在 Visual Studio 中。但是函数本身无法像逻辑应用程序那样连接如此多的数据源。我喜欢使用的一种方法是将两者结合起来:

*   创建一个由您感兴趣的数据源事件触发的逻辑应用程序。
*   当事件发生时，逻辑应用程序触发。所有与事件相关的数据在工作流中都是可用的。
*   然后，逻辑应用程序调用一个 [HTTP 触发函数](https://marcroussy.com/2019/06/14/http-trigger-function-request-validation/)，在消息体中传递相关的事件数据。
*   用您选择的语言编写的函数接收事件数据并做任何需要做的事情。
*   如果需要，您可以在工作流中调用多个函数，将数据从一个传递到另一个。

这样做有一些好处。显然，逻辑应用程序流程很小，因此很容易理解。大部分业务逻辑都是用代码编写的，所以也很容易理解。

更有趣的是，这种方法让您可以在 Logic 应用程序中从头到尾可视化整个过程。一眼就能看出流程失败的地方，并根据需要采取措施。

有很多这样的场景，将一个逻辑应用程序和函数结合起来比单独使用任何一个都更容易维护。将它们结合在一起可以实现系统间的无缝交互。

# [](#automating-everything)自动化一切

在一个理想的世界里，我们编写的应用程序像时钟一样运行，没有由错误引起的不良副作用。现实有些不同。比你我愿意承认的更频繁的是，需要执行手动操作来快速解决一些无法预见的导致生产崩溃的情况。尤其是无法快速修复的旧业务线应用程序，因为它们没有持续的部署渠道作为后盾。

当这些问题突然出现时，函数是解决它们的一个很好的方法，并且可以关注应用程序中发生的事情。需要验证某个业务事件是否在某个时间之前完成？您可以编写一个定时器触发函数来实现这一点。想要在某个事件发生时执行某个动作？您可以编写一个事件中心触发器来监听该事件。说到这种类型的互动，天空是无限的。

从 DevOps 的角度来看，HTTP 触发器函数提供了许多可能性。业务线应用程序很少有千篇一律的发布过程。可能存在需要重置的状态、需要增加的构建定义、需要清理的陈旧分支，以及谁知道当软件发布时还需要发生什么。只要您的 CI/CD 工具支持 webhooks，您就已经设置了 HTTP 触发器功能。

功能自动化最大的好处是它们提供的可追溯性。每个功能都像其他代码一样被编码、测试和部署。最重要的是，Application Insights 会记录每一次执行，因此不会怀疑哪些执行了，哪些没有执行。没有什么是靠运气的。

# [](#building-a-proof-of-concept)构建概念证明

即使是业务线应用程序最终也会寿终正寝。当他们这样做时，通常是因为商业模式已经发生了如此巨大的变化，以至于需要在方向上进行大规模的改变。

从头开始构建一个新的应用程序可能会有风险，所以首先构建一个概念证明来测试产品管理人员和开发人员的想法、假设和偏见是一个好主意。从技术角度来看，这是一个尝试新技术的机会，这些新技术可以帮助您更快地交付，而不会影响可伸缩性、可靠性和质量。

这些需求使得 Azure Functions，更一般地说是无服务器，成为构建概念验证的完美平台。你已经知道函数对于 Azure 中的事件反应非常有用。但是，与其用 ASP.NET 核心构建 HTTP API，不如看看你能用 HTTP 触发函数和 API 管理做多少事情。该特性集足够丰富，可以构建一个成熟的应用程序，更不用说概念验证了。

类似地，**函数非常适合构建任何类型的异步后台工作器**。几乎不需要任何配置，您就可以将消息从存储队列和服务总线中出队，以执行任何需要的处理。编写等效的工作服务或控制台应用程序肯定会耗费更多的时间。

从运营的角度来看，您不需要花费大量的时间来学习如何正确地管理运行时环境。它已经完全处理好了，所以您可以专注于编写代码，而不是管理基础架构。

最重要的是，Function 的成本模型意味着，如果你的 POC 根本没有被使用，它不会花费一分钱。如果流量激增，您也不会急于提供额外的资源来满足需求，因为功能会根据负载自动扩展和缩减。

不知不觉中，POC 将变成 MVP，而 MVP 将变成在生产中运行的完整应用程序。

# [](#wrapping-up)包装完毕

函数有许多方式可以帮助您成为更好的企业开发人员。无论您是在构建业务线应用程序的下一个迭代，自动化日常任务，集成不同的数据源，还是只是尝试看看有什么可能，您都不能在功能上犯错误。这是一个现代而灵活的平台，可以承受打击并继续运输。

你可以通过阅读我的[开发指南](https://marcroussy.com/guides/#azurefunctionsguide)来学习所有你需要知道的关于用 Azure 函数开发的知识。

* * *

在[https://docs.microsoft.com/azure/azure-functions/](https://docs.microsoft.com/azure/azure-functions/?WT.mc_id=servsept_devto-blog-cxa)了解更多关于微软 Azure 如何实现你的无服务器功能。