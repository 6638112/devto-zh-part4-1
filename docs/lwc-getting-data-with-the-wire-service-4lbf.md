# LWC——通过通讯社获取数据

> 原文：<https://dev.to/brettmn/lwc-getting-data-with-the-wire-service-4lbf>

[https://www.youtube.com/embed/9jZBTmTZjq0](https://www.youtube.com/embed/9jZBTmTZjq0)

你好，我是布雷特·WIPDeveloper.com。上次我们使用闪电数据服务从 Salesforce 接收数据。这次我们将了解如何使用网络服务从 Salesforce for component 获取数据。

在我们走得太远之前，我想花点时间感谢这一集的赞助商。仅仅是一些应用程序它们可以帮助你从你的技术投资中获得更多，在 justsomeapps.com[查看它们](https://justsomeapps.com)

如果你想成为赞助商，或者如果你觉得我在 WIPDeveloper.com 创作的内容有用，并愿意支持更多内容的创作，你可以去[patreon.com/BrettMN](https://www.patreon.com/BrettMN)然后附上下面的链接。取决于你回到什么水平。你可以让自己的名字出现在博客上，在互联网上流芳百世。

现在，让我们开始学习使用有线服务。要使用 wire 服务，我们必须从 Lw c 集合中导入它。因此，除了 lightningElement 和 api，我们还引入了服务。连线服务是一个类似于 api 装饰的装饰器。所以我们要加电线。

这实际上是一种方法。因此，我们将把它添加到一个属性用户中。但是这个方法

我们需要提供一个方法和一些额外的细节。所以我们首先要做的是导入一个额外的。我们想引进一种方法，这样得到记录

导入 getRecord。我们将从 lightning/uiRecordApi 导入它。

现在这个方法…

Visual Studiop 代码积极地导入了一些东西，我们不需要那个用户。

现在，我们使用 getRecord 方法作为 wire decorator 中的第一个属性。

这将有助于我们通过网络呼叫 Salesforce。我们将与网络服务合作，以获得我们想要的记录。因此，要获取记录，我们必须向它提供 recordId。

所以我们给它提供$id。

所以网络服务知道从我们的实例中获取 id 属性。我们还必须为它提供一些字段，因为我们想从用户那里获得信息

我忘了，这个必须在一个物体上。因此必须向 Id 属性传递一个 recordId。

关闭对象，这样它就不会生气了。

现在我们要告诉你。

现在我们有几种不同的方式来达成交易，我感兴趣的是尽可能容易地访问数据。因此，我将在字符串中编写代码，以确定要从用户对象中删除哪些字段。您可以导入对对象字段的引用，但这似乎超出了我们现在所做的范围，我只想为我们获取数据。因此，我将获取用户名、电子邮件、公司名称和电话号码。

现在这些都作为数组传递到这个数组或者字段的末尾。这就是我们田地所需要的一切。

现在，一旦页面加载并且有了 recordId，这个 wire decorator 将填充用户记录

或者在本例中为 userId，因为 userId 仍在被导入。

我们如何将这些价值传递给我们的用户？我们可以试着把装订放在底部，看看是什么样子。我将把它提交给 Salesforce，让我们来刷新几次

它说 object object，因为我们没有选择我们想要的属性

toString 对象。上面只写着物体物体。所以让我们回到这里。

我想把这个改成电线。耶。但是现在我想做的不仅仅是用户，而是名字。

所以在名字属性上。

现在，我将在 JavaScript 中使用一个 getter 来公开名称。因此

返回用户.数据.字段.名称.值

因此，一旦填充了这个用户对象，它就会有一个名为 data 的属性。

这将有一个名为 fields 的子属性。其中一个字段将被命名，因为我们请求并希望从该字段中获取值。所以如果我把这些部署到临时组织。

刷新页面

那不是我所期待的。

哦，傻瓜。必须将 get 放在方法之前。

有点奇怪的是，它的行为方式，但是

让我们重新部署，刷新页面。看看这需要多长时间。

现在可能会有一个错误。这就是为什么可能会有延迟。它可能在评估物体时有困难。

让我们等一会儿，看它会不会弹出来。

看起来不会弹出来。所以我想做的是。

我对用户对象做了很多假设，认为所有这些值都存在。

所以，我之前经历的一件事是，我得到的字段不是有效值。

所以我们取了两个空的或者未定义的字段

我们无法评估名称或价值。所以它会出错。为了解决这个问题，我做了一件有趣的小事。

因此，如果用户和用户.数据和用户.数据.字段和用户.数据.字段.名称

太多了。所以如果有一个用户检查是否有，如果有数据检查是否有字段如果有字段或者检查是否有名字如果有名字检查是否有值，只有这样它才返回那个值。

因为这是一个更好的我们总是需要回报的东西。

我将返回一个空字符串。我知道这不仅仅是归还一个。所以我为什么不直接返回一个值，然后我会返回这个值。只有在所有这些都满足之后，我才会设置它。

现在我们回来了，我们有一条返回的路。所以你不一定会对手机的去向感到困惑，因为只有一种方法可以做到这一点。

另一件事是，只有满足所有这些条件，这种情况才会改变。

所以我已经厌倦了说 user.data.fields.Name.value。

所以我们要部署这个。

现在你看到了，在第一次加载时，你没有什么要报告的显示用户名。

回到那个时代，在电讯社有机会返回任何试图评估它的东西之前。因为没有填充用户，所以没有数据、字段和名称。所以几张空头支票，我们就可以走了。但是我这里有几个额外的字段。因此

有些东西我要抄三遍。

所以这第一个我在做电子邮件，然后我会做公司名称。然后我会打电话。这将使电子邮件的错误少一些，我将把名称改为电子邮件，对于公司名称，我不想要大写的 C，因为这不是 JavaScripty 的方式。

检查您的姓名、公司名称

对于同一笔电话交易，可以更改电话名称。

保存这些，但是

现在让我们来部署它

在这里刷新。

在此查看我们所有的精彩价值，包括姓名、电话号码、公司电子邮件地址。但是因为我们在使用这个，或者看起来我们只是在验证我们得到了数据。

但我想要做的实际上是删除的闪电记录视图，因此我将删除这个和那个。

这将导致一个问题，我们在这里使用闪电输出场。

复制公司名称就不用打那么多了

粘贴到这里，我们也在这里使用光输出字段。

格式不正确。

保存它，重新部署。

恢复精神

并且它不再使用照明数据服务。

看起来格式有点变化，我想这是因为照明输出字段有不同的格式，并且应用了一个标题。

我不太担心，因为我们只是在玩。这就是使用有线数据服务获取数据，并在我们的 lightning web 组件中公开它。

## 链接

*   [只是一些应用程序](https://justsomeapps.com/)
*   [Patreon.com/BrettMN](https://www.patreon.com/BrettMN)

## 现在就这样。

记得报名参加 **[每周一次的单口相声！你可以得到我们关于 WIPDeveloper.com 的任何最新信息。](https://wipdeveloper.com/newsletter/)**

帖子[LWC——通过通讯社](https://wipdeveloper.com/lwc-getting-data-with-the-wire-service/)获取数据最早出现在[WIPDeveloper.com](https://wipdeveloper.com)上。