# 测试驱动开发实用指南

> 原文:[https://dev . to/jackmarchant/a-practical-guide-to-test-driven-development-485g](https://dev.to/jackmarchant/a-practical-guide-to-test-driven-development-485g)

自从我上一次写为什么测试很重要已经有一段时间了，但是在这篇文章中，我想我会对此进行扩展，谈谈为什么不仅单元测试很重要，而且全范围的自动化测试可以如何提高生产率，增加推动代码的信心，并帮助保持用户的满意度。

## [](#why-do-we-need-to-test-code)为什么我们需要测试代码？

每当用户与你的软件交互时，不管是通过应用程序还是 API 的一部分，代码都会被测试。不幸的现实是，当你的代码在用户手中时，发现它不起作用就太晚了。

为了减少这种情况发生的机会，我们在开发期间、开发之后(有时称为质量保证测试)，在向用户发布代码之前，甚至在发布之后测试代码。

在每一步，我们都有可能发现代码中的缺陷，并需要恢复或编写修复程序来补救这种情况。缺陷发现得越晚，影响就越大，修复缺陷的速度也越慢。

正是由于这些原因，我们在每一步都测试代码，建立代码做我们期望的事情的信心，以便它可以进入开发和发布过程的下一个阶段。

**定义**

以下是我在这篇文章中使用的术语的定义，并作为我如何看待每种类型的测试的描述(这些不一定是教科书上的定义)。

单元测试:测试对象是一个孤立的代码块，通常是一个没有依赖关系的单一函数。

集成测试(Integration Test):测试对象可以是一个有依赖关系的函数，或者同时测试多个函数/类。

用户验收测试:最接近用户如何与你的软件交互的测试，有时被称为功能测试。

## 测试是至关重要的——不管它们何时发生

作为编写代码的开发人员，尽早发现 bug 总是对您最有利的。理想的情况是，当您在代码本身上工作时，通过进行更改，然后运行自动化单元测试来找到它。这样，您就可以识别问题，通过为该场景编写测试用例来解决问题，然后继续前进。然而，并非所有的错误都是同样产生的，根据软件开发的本质，有些代码比其他代码更难测试。这就是为什么我们在开发周期的后期引入其他形式的测试，比如集成测试和用户验收测试。

这三种形式的测试:*单元*、*集成*和*用户接受度*，建立在彼此之上，形成一个测试金字塔。一般的想法是，单元测试应该容易创建和运行，因为它们没有外部依赖性。集成测试可以让你看到当不同的模块连接在一起时，是如何对某些输入做出响应的。最后，用户验收测试可能会将整个垂直切片(包含软件的许多部分，可能很慢或者很脆弱)置于测试之下。随着您从大多数(单元)、许多(集成)到一些(用户接受)，对整个系统正常工作的信心应该会增加。

进行测试并不能让错误完全消失，但是可以减少错误发生的频率，同时确保您所做的更改不会产生意想不到的副作用。

既然我们已经讨论了软件开发中测试实践背后的一些术语和理论，那么说起来容易做起来难。所以，让我们来谈谈你可以将测试整合到你的开发工作流程中的一些方法。

在大型代码库中，根据需要测试的代码，有一些测试策略是值得的，例如:

**新代码与现有代码集成:**

在这种情况下，尽可能多地对您编写的任何新代码进行单元测试是有意义的。在将新代码集成到现有代码路径的点上，您可能无法轻松地进行测试，但是因为您对单元测试有信心，所以您可以尝试集成测试或用户验收测试。前者可能会运行现有的代码路径，并确保新代码正在运行，同时确保现有代码成功运行。后者可能需要对整个特性进行手动或自动测试，在此期间运行您的代码。这有一个较慢的反馈周期，但同样重要的一步。

**修复现有代码中的一个 bug:**

当您在代码中发现一个 bug 时，无论是在开发过程中还是由用户报告的，修复它的最佳方式是编写一个测试(任何类型都可以)，然后修复代码，确保测试通过。

这将产生短期和长期影响:

*   这将确保您确实修复了错误。
*   并且，允许测试在将来再次运行，确保进一步的改变不会导致回归。

**从零开始接近测试金字塔:**

如果没有任何测试或者测试很少，通常代码很难测试，所以从金字塔的顶端开始向下工作是值得的。用户接受度测试是一个很好的开始方式，因为你可以模仿用户如何与软件交互。然后，随着更多测试的增加，对整体功能正常工作的信心可能会使工程师开始构建集成和单元测试，同时进行一些重构。

> 进行测试并不能让错误完全消失，但是可以减少错误发生的频率，同时确保您所做的更改不会产生意想不到的副作用。

## [](#the-effects-of-testing-over-time)测试随时间的影响

随着时间的推移，通过增加测试覆盖率来提高代码库的可维护性对团队、个人和企业都有巨大的影响。关于测试，在软件开发团队中存在许多围绕测试的谬误，阻碍了他们的集体生产力。

对于开发人员来说，一个难以测试的系统变成了一个黑匣子，因为不可能确切地说出某样东西是如何工作的。也就是说，打开盒子，取出零件，弄清楚它们是如何工作的是可能的。我发现了解一个系统的最好方法是引入新的测试。

人们普遍认为，测试驱动的开发只能通过编写测试来成功实践，就像它们是需求一样，然后编写代码来满足需求。我认为，在现实中，这并不是世界上多少软件被创造出来——因为这很难做到。

相反，对我来说，测试驱动开发是将任何类型的测试合并到开发周期中的实践，这意味着你不总是首先编写测试——可以在你完成之后或中途——重要的部分是一起使用自动化和手动测试来驱动在编写代码和知道它是否工作之间的更快的反馈循环。

实际上，正如在任何其他工程决策中一样，在向您的开发工作流中添加测试时，需要考虑权衡。让我们停止争论 TDD 是否意味着红绿重构，它所做的只是阻止人们实际编写测试，因为害怕他们做得不对。

总是会有测试，但是测试是什么，如何进行呢？在回答这些问题和用测试进行开发的过程中，你会发现它提高了你自己写代码的效率，并且最终会为你的用户提高你的软件的可靠性。

最初发表于[jackmarchant.com](https://jackmarchant.com)