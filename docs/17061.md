# 代码的出现——理想的袜子包装——谜题 4

> 原文：<https://dev.to/10xlearner/advent-of-code-the-ideal-stocking-stuffer-puzzle-4-c6c>

你好！我是 Xavier Jouvenot，这是关于代码出现的[系列的第三部分。这里](https://adventofcode.com)可以找到上一部分

对于这个新帖子，我们将解决 2015 年 12 月 4 日的第二个问题，名为“理想的圣诞礼物”。我将在 C++中提出解决方案，但推理可以应用于其他语言。

## 第一部分

### 问题

这个问题的完整版可以直接在[降临代码网站](https://adventofcode.com/2015/day/4)上找到，我在这里只描述问题的本质:

圣诞老人需要帮助挖掘 AdventCoins，一种奇妙的加密货币，作为预置提供给人们。

为此，他需要找到十六进制的`MD5`哈希，以**开头，至少有五个零**。MD5 散列的输入是一些秘密密钥，后跟一个十进制数。为了帮助圣诞老人，我们必须找到产生这样一个散列的最小正数(没有前导零:1，2，3，…)。

例如:

如果你的秘钥是`abcdef`，答案就是`609043`，因为`abcdef609043`的 MD5 哈希以五个零(`000001dbbfa...`开头，而且是这样做的最小的这样的数。

### 解

我不知道你们怎么想，但是，当我第一次读到这个问题的时候，我想:“这里发生了什么？😨".然后，我开始用谷歌搜索一些东西，想弄明白一些事情。

首先，我已经了解了什么是 [MD5](https://en.wikipedia.org/wiki/MD5) ，正如维基百科解释得很好，它是一种**广泛使用的消息摘要算法，产生 128 位散列值**。看了一下维基百科中算法的伪代码，我想到定义中广泛使用的**意味着其他人可能已经实现了这个算法。经过一番研究，我发现 OpenSSL 库实现了 MD5。所以，我用 Cmake 和包管理器[柯南](https://conan.io/)包含了 OpenSSL 库(我会在另一篇帖子里解释我是怎么做的)。瞧，现在，我可以做`#include <openssl/md5.h>`😃。**

 **现在我们有了可用的 md5 函数，我们有两件事要做。首先，我们必须让它易于使用。由于这个算法是 C 代码，我们必须修改它，使它更容易与`std::string`一起使用，并使它更具可读性。所以，我写了一个函数`std::string getMD5(std::string key)`来做这件事。你可以在这里看我的实现，但是对我来说这并不是一个有趣的部分。我将描述它，如果一些阅读这篇文章的人想要更多关于它的信息。

最后，我们必须使用这个功能，以便解决问题。

```
 size_t result = 0;
    while (true)
    {
        const auto str = secretKey + std::to_string(result);
        const auto md5Result = getMD5(str);
        if(md5Result.substr(0, 5) == "00000")
        {
            break;
        }
        ++result;
    }
    std::cout << result; 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

我们开始吧。正如您在这个解决方案中看到的，我们查看 md5 散列的前 5 个字符，并检查是否只有`0`。如果不是这种情况，那么我们尝试下一个数字，但如果是这种情况，我们可以帮助圣诞老人找到正确的答案🎅。

## 第二部分

### 问题

令人惊讶的是，这和第一部分的问题是一样的，除了一个“小”细节，我们必须找到允许我们找到以 6 个零开始的第一个散列的数字。

### 解

为了找到解决方案，我们所要做的就是替换代码中的一行:

```
 // Old line
    if(md5Result.substr(0, 5) == "00000")
    // New line
    if(md5Result.substr(0, 6) == "000000") 
```

<svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg viewBox="0 0 448 512" class="highlight-action highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

瞧，现在我们可以编译、运行我们的程序并等待解决方案。我们等了又等。因为是的，加密货币不是快速开采的。举个例子，在调试模式下，我的机器花了`4.12`秒找到第一个问题的结果，但是用了`146.18`秒，2 分多钟才找到第二部分的解决方案！在发布模式下，第一个问题花了`3.47`秒，第二个问题花了`34.24`秒。

当然，有一些方法可以改进我刚刚描述的这个解决方案，并且在这个解决方案上运行一些基准可以帮助更快地挖掘，但是，这不是这篇文章的目的。即使花了 2 分多钟，帮助圣诞老人也是非常令人满意的😉。

## 结论

你可以注意到，这个帖子里写的解决方案，并没有包括所有制作运行程序的源码，而只是解决这个问题的源码中有趣的部分。如果你想从头到尾看这些节目，你可以登录我的 [GitHub 账户](https://github.com/Xav83/AdventOfCode/tree/2015.04/2015/Day4)，探索完整的解决方案，添加评论或提问。

这里是我们使用过的 std 方法和容器的列表，我非常鼓励你去看看它们的定义:

*   [std::string::substr](https://en.cppreference.com/w/cpp/container/vector)
*   [std::to_string](https://en.cppreference.com/w/cpp/algorithm/sort)
*   [openssl/md.h】的缩写](https://www.openssl.org/docs/man1.0.2/man3/MD5.html)

谢谢你的阅读，希望你喜欢😃

直到下一部分，享受学习和成长的乐趣。**