# 让 Ember 节食并促进创新

> 原文:[https://dev . to/tschoartschi/send-ember-on-a-diet-and-thrive-innovation-2 AEF](https://dev.to/tschoartschi/send-ember-on-a-diet-and-thrive-innovation-2aef)

# [](#send-ember-on-a-diet-and-thrive-innovation)节食送余烬，茁壮创新

2019 年博客文章的截止日期很快就要到了，但和往常一样，我需要截止日期来完成我的工作。

首先，我想提供一些关于我和我工作的公司的背景信息。我们在 Roomle 使用余烬，因为它是非常早期的。我们对 Ember 项目的首次承诺可以追溯到 2013 年初。在这段时间里，我们获得了很多经验，并了解了余烬的好与坏。我们还推出了使用 Glimmer.js 作为 UI 框架的生产网络应用。现在，我们用 TypeScript 重写了 Ember Octane 中主要应用程序的部分内容，因此我们也知道如何成为早期采用者。

因为我们是一家小型创业公司，专注于打造我们自己的产品，我们没有贡献插件或大量代码，但我们帮助解决了一些问题，还为 Ember 生态系统的几个项目创建了小型 PRs。

在我开始之前，我想添加一个免责声明:我们真的很喜欢 Ember，我不想给人留下我们不喜欢它的印象。这篇博文是关于有待改进的地方，而不是美好的事物😉

## [](#recap-of-roadmap-2018)🤔回顾 2018 年路线图

在深入未来之前，我想快速回顾一下 2018 年的[路线图。我想提一下，我是作为一个不属于任何核心团队的局外人来做总结的。所以要意识到我很有可能错过了一些重要的东西。然而，我认为我可以提供很好的反馈，因为这也是其他非贡献者可以看到框架进展的方式。让我们看看去年我们作为一个社区想要改进的主题:](https://github.com/emberjs/rfcs/blob/master/text/0364-roadmap-2018.md)

### [](#%F0%9F%97%A3-improve-communication-and-streamline-decisionmaking)🗣改善沟通，简化决策

在这个话题上有了很大的进步。此外，切换到不和谐是好的，进展顺利。但是我认为围绕着 Ember Octane 的交流并不太理想。人们正在阻止项目，因为他们不想从“遗产”烬开始。由于 Ember Octane 仍然没有发布(只是预览版)，我的一些同事四处寻找其他框架，其中一些人离开 Ember，转而支持 Vue 和 Vue-CLI(主要是因为更好的构建工具)。

在我看来，围绕辛烷的交流有两个大问题

*   **通过沟通**:很难跟踪正在发生的事情，以及采取什么样的方式是有意义的。当然，每个人都可以停留在“快乐之路”,但是当你开始一个新项目时，你不想用旧的方式做事。我们还在 Ember Conf 2019 之前不久启动了一个新的 Ember 项目，我们也担心我们会以传统的方式启动一个全新的应用程序。我的感觉是围绕辛烷的交流产生了一些不确定性。

*   **承诺过多而交付不足**:当我们看到为 Octane 设定的目标时，许多目标都被推迟了(尤其是期待已久的版本改进，我将在下一节详细介绍该版本)。不要误会我的意思，我真的很喜欢 Ember Octane，但大多数工作都是为了开发者体验。我知道像原生类这样的东西为进一步的改进奠定了基础，但是现在这些东西还没有被真正利用。Ember 有一个承诺的历史，例如:可路由组件，模块统一等，这些从未实现，因此我认为我们需要非常小心我们的承诺，以及我们如何向公众传达这些承诺。

**tldr；**交流大大改善了，但在某些情况下，我们应该对交流的内容和方式更加敏感

### [](#%E2%80%8D%E2%99%82-finish-what-we-started-and-ship-ember-octane)🏋‍♂完成我们开始的工作，运送灰烬辛烷

这两个路线图目标有很多重叠。我认为 Ember 社区能够完成很多已经开始的事情。关于 Ember Octane，我们未能在 2018 年路线图的时间内发布它(我认为它仍然是一个预览版)。我还想强调 Ember Octane 的一些目标，这些目标没有发布，我认为应该再次成为 2019 年路线图的一部分，因此我从 2018 年路线图的一些引文开始:

> 内容应用程序，其中页面是大量的文本，第一次加载是至关重要的。在性能受限的环境中，Ember 的强大约定可以帮助开发者默认构建更快的应用。

这里的关键词是**第一次装载**。如果你做了`ember init`并创建了一个简单的“Hello World”应用程序，JS 包总计约 700KB。我的第一次刺绣实验更好，但仍然没有交付令人满意的结果。这个包仍然有大约 400KB 的 JavaScript。那太多了。虽然我真的很喜欢 Ember，但由于 JS 包的大小，我们不得不为某些项目离开 Ember。不是每个项目都是为后端输入数据的管理界面。尤其是对于我们的电子商务项目，仅仅因为捆绑包的大小，Ember 并不是一个可行的选择。我希望看到这方面的巨大进步💖

> 摇树以自动移除应用程序未使用的代码

这和上面的观点有很大关系。就撼动树木而言，Ember 必须成为一流的行业领先企业。由于 Ember 是一个“包含电池”的框架，如果我们没有出色的树摇动，我们的捆绑包将总是巨大的。

> 苗条的构建，不赞成使用的特性被从框架代码中剥离出来。我们将更加积极地反对那些没有被广泛使用的代码。

我认为像刺绣这样的现代构建工具应该删除所有不需要的东西。无论某个功能是否被弃用。

> 从无目标:进一步优化虚拟机。Glimmer 的性能是行业领先的，在大多数 Ember.js 应用程序中不是瓶颈。在这一点上，Ember.js 负载是主要的性能瓶颈，我们应该将注意力转向在那里实现更好的性能。

总而言之，核心团队意识到有效载荷大小是一个大话题，并在 2018 年路线图中得到相应解决，但我们没有实现这一目标。

* * *

## 我们真的需要降低有效载荷的大小，只运送初始渲染所需的东西！

* * *

其他的都要按需加载，而且是懒懒的加载。由于 Ember 有很强的约定，我们可以让这个复杂的东西对开发者来说非常愉快。

**tldr；**我 2018 年的总结是:请请请**修正 Ember** 的有效载荷大小，使其成为更多种类项目的选择🚀

## [](#wishes-for-2019)🎁2019 年的愿望

我认为我们应该关注 2018 年的溢出效应，但我也对 2019 年抱有希望

### [](#thrive-innovation-again)👩🏼‍🔬再次繁荣创新

几年前，Ember 在许多方面都处于行业领先地位。让我们想想伟大的路由器、ES6 和 ES 模块的采用、Promises 的使用、CLI 等。在过去的几年里，Ember 似乎落后于大型框架，很难跟上。

我不认为我们应该尝试比其他人更快地创新，但我们应该再次开始在 Ember 空间内蓬勃发展创新。也许创建一个“创新”团队是个好主意，就像我们有一个核心团队、学习团队等等。创新团队可以专注于 Ember 独有的东西。一些我在其他框架上没有见过的东西:

*   二进制模板
*   将引擎呈现为 WebAssembly 模块
*   与 Ember 没有直接关系，但类似 css-block 的东西会很棒

前两个功能已经在 Ember Conf 2018 上展示过，但仍未发货。烬应该再次有一些特点，使它从所有其他的区别开来。“约定胜于配置”本身不足以保持相关性。

### [](#the-build-and-embroider)👷建造和刺绣

许多人已经指出，刺绣是 2019 年最重要的项目。我完全同意，因为这将使 Ember 使用行业标准的工具进行包装。一些希望刺绣和改进的建造系统:

*   **创建不同版本的 JavaScript 包**,这样我们就可以向现代浏览器交付小型的现代代码，而向旧浏览器交付遗留包
*   **只包括需要的东西**也就是摇树
*   **轻松偷懒装东西**。在 HTTP2、服务器推送、预加载等以及 async/await 等 JavaScript 原语时代，我们应该开始广泛使用延迟加载

如果我们有一个非常棒的构建和捆绑工具，我们也可以实现`npm install your way to Ember`的承诺。我认为我们应该重新命名这个短语，因为一个`ember init`仍然可以将所有的包安装到 node_modules 文件夹中，但是开发者只有在他/她在应用程序的某个点导入它的时候，才会在有效载荷中添加一些东西。我喜欢这个想法，因为我们仍然可以交付一组精选的工具，并且不会惩罚只需要框架的一小部分的用户。

如果我们继续使用西兰花，我们必须更好地记录如何编写插件。如果我真的要写一个构建插件，我总是会复制类似的西兰花插件并删除我不需要的东西。经常要用`node --inspect-brk`调试。开发构建插件一点也不好玩

### [](#rethink-stability-without-stagnation)👵反思“稳定而不停滞”

我真的很喜欢 Ember，它让升级变得容易，并且没有破坏向后兼容性。但每当我开始一个新的 Ember 项目时，我都会想:

> “为什么我要背负多年前的所有包袱”

这也让我们觉得关注向后兼容性会大大降低我们的速度。我不知道如何解决这个问题，我认为很难在“打破”东西和让一切保持原样之间找到平衡点。也许我们可以为旧应用程序提供聚合填充，并从 Ember 代码库中删除遗留代码。有时候我觉得我们更倾向于停滞不前，尤其是在大的主题上，比如构建、控制器、新的文件系统布局等等。

### [](#typescript)💪以打字打的文件

我们从 2019 年 2 月开始与`ember-cli-typescript`合作，效果非常好。我们喜欢 TypeScript 给我们带来的生产力提升。此外，它还使项目的所有开发人员更容易发现代码。使用 TypeScript，不太可能有人实现已经存在的东西。特别是对于库和插件来说，拥有像代码完成和智能感知这样的东西是很棒的。

尽管 TypeScript 和 Ember 配合得很好，但我认为我们应该在 Ember 生态系统中进一步改进对 TypeScript 的支持。如果前 100 个插件都有 TypeScript 定义并被编码为使用 TypeScript，那就太好了。

最近我们在 TypeScript decorators 和新的 TC39 decorator 规范上遇到了一些麻烦。不确定那里有什么问题，但是我们也应该总是考虑 TypeScript 用户。

除此之外，如果能看到诸如类型化模板之类的东西，那就太棒了。

### [](#glimmerjs)✨一针一线. js

我们在我们的一个项目中使用 Glimmer.js，它工作得很好，但感觉有点像死亡之地。有这么多的发展在开始进行，但现在似乎所有的力量都捆绑在一起，让烬辛烷运出。我们需要一些方法让 Glimmer.js 用户回到 Ember 的“快乐之路”。也许新的建造系统和刺绣会有所帮助，但现在我们对微光感到失落。☠

### [](#emberdata)🚚余烬数据

当我们开始上一个 Ember 项目时，我们不得不雇佣新的开发人员。主要的余烬概念对他们来说很容易理解。但是当他们有一些问题与灰烬数据相结合时，经常会产生混淆。从学习的角度来看，我认为有三个主要挑战

*   什么是余烬数据，什么是余烬？界限非常模糊。
*   为什么我们有时需要像`objectAt`这样的特殊方法，而有时不需要？为什么我们在应用原生数组方法之前需要`toArray`等等。
*   改进文档，解释什么是 Ember-Data，提供一些最佳实践和方法，并与其他框架的工具进行比较。一些从 React 转来的开发人员总是认为 Ember-Data 是 Ember 的翻版

此外，我们还需要考虑如何减少余烬数据的有效载荷大小

### [](#monorepos)🌃单休

我们有一些单一回购，将 Ember 项目纳入这些单一回购并不总是微不足道的。这将是很好的有一些文件或最佳做法，就如何设置一个单一回购与几个余烬项目。此外，让 mono-repo 内部的代码共享变得更容易也是一件好事。也许这已经是可能的，但我没有找到一个好的教程。所以我认为，如果一个雄心勃勃的 web 应用程序框架也能在高级指南的某个地方涵盖这个主题，那将是有益的。例如，我们有以下设置:

```
mono-repo/
├── common-stuff/
│   └── this code is imported by all projects
│
├── ember-project-1/
│   └── want to import from common-stuff but that's harsd
│
├── ember-project-2/
│   └── want to import from common-stuff but that's harsd
│
├── three-js-project/
│   └── imports from common-stuff it's super easy here
│
└── some-node-js-2/
    └── imports from common-stuff it's super easy here 
```

我没有找到从`common-stuff`文件夹导入的简单方法。如果我能做一个`import`就太好了。

### [](#simplicity)💫简单

正如许多其他博客帖子中指出的那样，2019 年应该是我们重新思考旧概念并开始弃用它们并将其从框架中移除的一年，例如:控制器。这里就不赘述了，因为其他很多博文都描述的很好。此外，我们应该删除感觉不像 JavaScript 的概念。Run.Later vs setTimeout 等。但在我看来，这些事情更是次要的。我们真的需要关注构建、捆绑包大小以及与更广泛的 JavaScript 社区的一致性。

## [](#summary)总结

| tldr | 如果你没有太多时间，就看看这个表格 |
| --- | --- |
| Two thousand and eighteen | 多交流，但对谁和如何交流更敏感 |
|  | 装运从辛烷中分解出来的东西 |
| 👩🏼‍🔬创新ˌ革新 | 完成一些行业领先的功能，如二进制模板等 |
|  | 创建一个创新团队，就像我们有团队为指南，余烬数据和核心 |
| 👷建筑 | 让刺绣成为 2019 年的重中之重 |
|  | 依靠行业标准工具 |
|  | 记录并简化构建插件的创建 |
|  | 启用一级树抖动，代码删除(又名苗条) |
|  | 让延迟加载像使用动态导入一样简单 |
|  | 🔝**固定捆绑尺寸**🔝 |
| 👵完成事情 | 不要让“稳定而不停滞”的口号阻碍我们交付特性 |
| 💪以打字打的文件 | 在整个生态系统中拥抱打字稿 |
|  | 键入前 100 个插件，并可能在 emberobserver 分数中包含类型信息 |
|  | 创建新功能，如类型化模板 |
| Glimmer.js | 提供一个从 Glimmer.js 回到“快乐之路”的方法 |
|  | 不要忘记 Glimmer.js 用户 |
| 🚚余烬数据 | 改进成员数据文档 |
|  | 阐明灰烬数据在生态系统中的作用 |
|  | 解释如何将 Ember-Data 与像 Redux 这样的工具进行比较，以供新的 Ember 用户使用 |
|  | 修正余烬数据的有效载荷大小 |
| 🌃单休 | 制作如何在 mono-repos 中使用 Ember 项目的指南 |
|  | 在一个 mono-repo 中使从其他包导入文件变得容易 |
| 💫简单 | 重新思考旧的概念，反对并消除它们 |
|  | 与更广泛的 JavaScript 生态系统保持一致 |
|  | 让它成为一个重要但不是最优先的事情 |
| _____________________ | ________________________________________________________________________ |