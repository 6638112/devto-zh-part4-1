# 我应该使用这个舵图吗？

> 原文：<https://dev.to/yuvalo/should-i-use-this-helm-chart-ja3>

有这么多的掌舵图，很容易选择一个就走，但是草率的决定可能会回来困扰你。

我不得不承认官方的舵库已经走过了很长的路，如果说它以前主要是提供半成品的图表，那么现在大部分的图表已经可以工作了！

因此，在你盲目地选择一个舵图并将其纳入你的项目之前，我建议你仔细阅读下面的列表，并确保你做了尽职调查。

* * *

**tldr:选择舵图时你应该记住的事情:**

1.  好的实现看起来像什么？
2.  [这是该应用程序的正确回购吗？](#is-this-the-right-repo-for-this-application)
3.  [阅读文档- Readme.md](#readme-hadoop-as-an-example)
4.  [这个项目够积极吗？](#project-activity)
5.  [这个图表稳定吗？](#stable-enough)
6.  你必须修改它吗？或者按原样使用。
7.  这张图表对我的要求来说是不是有点过分了？
8.  安全性如何？
9.  [拿去试驾吧。](#take-it-for-a-spin)

* * *

## 一个好的实现是什么样子的？

舵轮图可以让你的生活更轻松。它允许您使用公共或官方知识来优化应用程序的实现。舵图也倾向于非常一般化地支持多种用例，这样做可能会导致您的实现不“适合”您的需求。为了避免这个罪魁祸首，并且能够在选择图表时做出正确的决定，您需要对底层解决方案有所了解。

在考虑 Kubernetes 之前，我做的第一件事就是花时间研究这个应用程序是如何工作的。

*   成功的实现看起来像什么？
*   有没有办法让它高度可用？如果是，我有什么选择？
*   安全呢？TLS，硬化，AAA
*   我有哪些大规模运行该解决方案的选项？

只有这样我才会去库伯内特。有了这些积木，我的决定更加明智，也更少了些货真价实。

我接着看:

### 冗余

有些图表实现冗余的方式可能适合也可能不适合您的整体架构。有时图表是以一种适合不同用例的方式编写的。
一个例子是雷迪斯集群 vs 哨兵。这是 Redis 高可用性的两种不同实现，每种实现都有单独的导航图。

### 运行您需要的版本

在某些情况下，图表支持应用程序的特定版本，可能比最新版本稍晚一些。
包含应用程序设置的图表元素(如配置图和机密)在最新版本中可能会中断。

### 服务发现

您的应用程序将如何找到彼此并协同工作？Kafka 图表过去支持内部联系，但未能解决暴露集群外经纪人的问题。现在情况不再是这样了，但这是一个可以避免的潜在时间下沉的极好例子。
快速浏览一下 Kubernetes 服务的配置，您就能清楚地了解如何与应用程序交互。

### 刻度

大多数图表都是按比例绘制的，但对于您的用例来说，这可能会有些不同。确保您的“比例”视图与图表一致。

## 这是该应用程序的正确回购吗？

嗯，我敢打赌，你开始你的旅程将快速谷歌搜索图表。然后发生了四件事之一:

1.  点击第一个结果，你就进入了官方的头盔库。
2.  最上面的结果是创建该服务的公司(例如 elastic.co)的一篇博客文章。它可能会带你到他们的官方头盔回购。
3.  非常随机的 GitHub 项目集合。
4.  没有实际结果。

我通常在场景#1 和场景#2 之间来回切换，试图找出哪一个更好地满足我的需求。两者都是很好的起点。

如果我最终选择了第三种情况，这通常意味着我只会把这些项目作为灵感，尽量不“按原样”使用它们。万一没有任何结果，你还有很多工作要做。

## Readme -以 Hadoop 为例

每个好的图表都有一个信息丰富且有用的自述文件。即使文档很短，它也能为您提供有价值的信息或为您指明更好的方向。

> 该图表主要用于 YARN 和 MapReduce 作业执行，其中 HDFS 只是作为一种在框架内传输小工件的手段，而不是用于分布式文件系统。数据应该从基于云的数据存储中读取，如谷歌云存储、S3 或 Swift。

*摘自 stable/hadoop 图表。*

看，如果你想用它来存储大型数据集，可能不是最好的选择。

[stable/Jenkins](https://github.com/helm/charts/tree/master/stable/jenkins) 图表是自述文件(和总体图表)的一个很好的例子。您可以看到哪些选项可用于覆盖，它会提示您可能出现的问题，以及您可以使用的功能。

有时一个图表清楚地表明它已被否决，并包含一个不同的链接。

自述文件不仅提供信息和记录，还用于营销和建立信任。你能相信这张图表吗？

## 项目活动

当您在 GitHub 上查看自述文件时，请在页面上寻找其他线索:

*   这个回购有几个守望者，星叉？
*   阅读一些问题，看看它们是否得到了解决。
*   项目维护人员是否在考虑拉取请求？
*   最后一次提交是什么时候？
*   这张图表看起来是积极维护的吗？

就像选择一个外部库一样，以上几点是你是否应该使用这个图表的一个很好的指标。

## 够稳了吧？

在我们目前的 DevOps 状态下，一切都处于 Beta 或 Alpha 阶段，由于缺乏更好的选择，实验项目正在生产中运行。掌舵图没有什么不同，你可能会发现自己在看“孵化器”图，而不是“稳定”图。
即使在“稳定”状态下，您也可能会看到图表没有 100%准备好投入生产的指示。

我的另一个最爱是由供应商发布的精彩公关博客帖子，宣布他们的官方图表，甚至是即将到来的运营商。太糟糕了，帖子的日期是一年前，图表仍在“阿尔法” Look 是更安全的选择，但不要因为一个标签就排除任何可能性。押注一种新的做事方式可能比使用错误的解决方案更安全。
下面的步骤可以帮助你自己决定这张图表对于*你的*需求是否足够稳定。

## 还要修改吗？

虽然图表是为了支持尽可能多的用例而编写的，并且使模板完全不可读，但是它们不能解决所有的问题。
也许你有一个独特的配置，需要额外的设置？或者，假设您需要添加模板中没有的元素。如果你意识到要使图表具有可操作性需要太多的修改，考虑自己写一份。

## 矫枉过正？

每个公司都有其对失败、不同资源和前景的容忍度。一些图表在黑色星期五推出了完全成熟的服务架构，足以支持亚马逊(实际上不是)，但在您的情况下，它将在本地 Kubernetes 集群上运行应用程序，以满足低得多的用户集。
开销值得吗？从硬件资源到支持图表本身，尽量保持简单。

## 安全

这本身就是一个很大的主题，不久前我写了一篇关于用安全的心态审查 Helm 和 Kubernetes 代码的短文。我强烈建议你看一下。有一些重叠，但它应该给你一个好主意，你需要记住什么，当评估掌舵图。

## 带它兜风

这是显而易见的——试驾一下舵图。花几个小时，尝试在您的开发集群或本地机器上实现它。通过尝试实现一个图表并尝试为您的用例配置它，您可以学到很多东西。
它可以让你对定制图表的努力有所了解，并对项目范围给出更好的估计。在某些情况下，您可能想快速排除它，为以后节省时间。