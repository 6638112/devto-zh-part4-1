# 对完美软件架构的追求

> 原文：<https://dev.to/jpeg729/the-quest-for-the-perfect-software-architecture-4g98>

在这个系列中，我将深入探讨 ORM、自动数据对象映射、依赖注入和现代软件开发的其他主题。我将研究每种方法的利弊，并考虑我能找到的任何替代方法。

## 我是谁？

几个月来，我一直是一个中型架构的首席开发人员。有些部分很难理解意大利面条式的代码，其他部分则清晰得多。我与前一个项目负责人一起开发了一个新的架构，该架构应该给我们结构，并帮助我们更快地开发，并减少错误，但我们发现它很笨重，并不是完全没有错误。我们怀疑它可能开始让我们慢下来。

也许我被蒙蔽了，也许我是一个不可救药的梦想家，但我不禁想知道是否有更好的方法...

## 当前架构

我们将数据存储在 SQL Server 中。数据结构是在 C#类中定义的，EntityFramework 使用它来生成数据库模式和迁移。

为了更快的加载和更高级的查询，我们将这些数据的复合视图存储在 NoSQL 数据库中。基本上我们把它作为一个美化的缓存，我们很难保持它的最新。

缓存更新和少量业务规则通过拦截 EntityFramework 中每个写操作的代码运行。

我们使用 HangFire 来排队和运行必须在后台运行的作业。HangFire 给了我们一个漂亮的界面和免费的自动重试。

代码模糊地遵循分层架构，但是时间老人和几个实习生的流逝并没有给它带来任何好处。

目前这款应用运行在一台服务器上，服务于一小部分用户，但许多应用没有这种奢侈。这就引出了一个问题:为了从云中大规模运行，我们可能需要改变什么？

## 本系列中

这是一个临时的路线图，可能会改变。

1.  SQL ORM 的，特别是我们使用的:EntityFramework。

    *   查询和读取数据
    *   从链接表中读取数据的低性能
    *   变更跟踪以及为什么它可能是坏的
    *   还有更好的方法吗？
    *   利弊:我喜欢的和我不想要的。
2.  NoSQL 数据库

    *   用作缓存以及保持其最新的困难
    *   NoSQL 与 SQL:我们能否在一个存储提供商中同时拥有这两者？
3.  自动映射器

    *   它能做什么
    *   这有什么不好？
    *   运行时映射与自动化代码生成
4.  依赖注入

    *   我们如何使用它
    *   我们为什么使用它，我们真正需要它做什么
    *   双重依赖树
    *   替代方法
5.  来自函数式编程世界的想法，第 1 部分

    *   不变
    *   如何将不变性和实体框架结合起来
    *   如何将不变性和自动映射器或其替代品结合起来
6.  来自函数式编程世界的想法，第 2 部分

    *   有趣的是。选择，。SelectMany、Linq 和查询语法
    *   我们应该注射什么，注射在哪里？
7.  对变化做出反应:事件、行动者等等

    *   对某些类型的变化做出反应的需要
    *   我们如何管理它
    *   我们可以使用微软奥尔良，Akka，或其他东西来代替吗？
8.  如果我们必须在云中大规模运行会怎样？

    *   我们需要做些什么改变？
    *   我们更喜欢做哪些不同的事情？
9.  把这一切联系在一起

    *   我最喜欢的配料
    *   将它们结合起来的方法
10.  (过了一段时间)事情的结果如何

    *   我们喜欢和不喜欢的部分
    *   如果我们重新开始，我们会怎么做。