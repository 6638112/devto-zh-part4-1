# cron 和 crontab:有些经典是永恒的

> 原文:[https://dev . to/dje mos/cron-and-crontab-some-classics-is-timeless-3i7b](https://dev.to/djemos/cron-and-crontab-some-classics-are-timeless-3i7b)

*   cron 和 crontab:有些经典是永恒的

作为计算机用户，我们经常需要安排应用程序或作业在给定的时间发生。备份通常发生在晚上，病毒扫描可能发生在晚饭后，系统更新可能发生在早上。当我们不坐在机器前时，自动执行日常任务通常很有用。本周我们将介绍 cron 守护进程，并演示如何使用它来快速设置周期性任务。

cron 是做什么的？cron 守护进程每分钟检查一次/etc/crontab 文件，查看是否有任务被调度，如果找到合适的任务，它就运行一个给定的程序。/etc/crontab 文件是一个文本文件，我们可以在任何文本编辑器中打开并检查它。让我们来分解我们将在该文件中找到的信息字段。

通常，crontab 文件会包含两行或多行设置变量。通常我们会看到一行设置了 shell 的路径，另一行列出了 cron 可以找到可执行文件的路径。这些可能如下所示:

```
 SHELL=/bin/sh
   PATH=/sbin:/bin:/usr/sbin:/usr/bin 
```

根据这些变量，我们将找到指定时间和在这些时间运行的任务的行。让我们来看一个计划任务的示例:

```
 15 * * * * root logrotate 
```

该行的前五个字段由数字或星星组成。这些字段表示一个给定的时间点，让我们知道任务将在何时运行。从左到右，这些字段指示任务将要运行的分钟、小时、月中的某一天、月中的某一天以及星期几。星星实际上意味着“任何”或“每一个”。第六列指示将使用哪个用户帐户来运行任务，最后一个字段是要运行的命令。在上面的例子中，我们将以 root 用户的身份运行 logrotate 命令。这将在一周的每一天，每月的每一天的每一小时发生 15 分钟。在以下示例中，我们将在每个星期天的中午以 root 用户身份运行备份脚本:

```
 0 12 * * * 0 root my-backup-script 
```

如您所见，我们将分钟字段设置为零，将小时设置为 12 点(中午)，将星期几设置为零(星期日)。克朗把星期天和零联系在一起，把星期一和一联系在一起...一直到周六六点。这里是另一个例子，我们从星期一到星期五每天晚上 6:30 清理/tmp 目录。破折号允许我们指定一个范围:

```
 30 18 * * 1-5 root rm -rf /tmp/* 
```

在大多数 Linux 系统上，不仅仅是根用户可以调度任务，普通用户帐户也可以创建自己的 cron 作业。这些用户计划的任务独立于/etc/crontab 作业，可以通过运行以下命令来访问:

```
 crontab -e 
```

crontab 命令将打开一个文本编辑器，并允许我们创建特定于我们的帐户的任务。特定于用户的计划和/etc/crontab 文件之间的主要区别在于，特定于用户的计划不包括用户名。例如，我的 crontab 文件中的以下条目将在每月的第一天早上 5:00 对我的文档目录执行备份:

```
 0 5 1 * * tar czf ~/mybackup.tar.gz ~/Documents 
```

如果我们希望看到我们在 cron 文件中安排的所有作业，我们可以运行

```
 crontab -l 
```

以获得完整的列表。最后，我们可以通过运行以下命令删除用户的所有计划任务:

```
 crontab -r 
```

cron 程序是一个非常灵活和强大的工具，可用于自动化过程，特别适合于安排备份和系统清理。这是一个非常方便的实用工具。

文章首发于[https://distrowatch.com/weekly.php?issue=20120416&mode = 68 # QA](https://distrowatch.com/weekly.php?issue=20120416&mode=68#qa)